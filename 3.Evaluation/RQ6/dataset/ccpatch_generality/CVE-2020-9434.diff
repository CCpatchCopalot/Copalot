diff --git a/src/x509.c b/src/x509.c
--- a/src/x509.c
+++ b/src/x509.c
@@ -1384,25 +1384,6 @@
   {NULL,      NULL},
 };
 
-#if OPENSSL_VERSION_NUMBER > 0x10002000L
-static LuaL_Enumeration check_flags_const[] =
-{
-#define DEFINE_ENUM(x)  \
-  {#x,  X509_CHECK_FLAG_##x}
-  DEFINE_ENUM(ALWAYS_CHECK_SUBJECT),
-#if OPENSSL_VERSION_NUMBER > 0x10100000L
-  DEFINE_ENUM(NEVER_CHECK_SUBJECT),
-#endif
-  DEFINE_ENUM(NO_WILDCARDS),
-  DEFINE_ENUM(NO_PARTIAL_WILDCARDS),
-  DEFINE_ENUM(MULTI_LABEL_WILDCARDS),
-  DEFINE_ENUM(SINGLE_LABEL_SUBDOMAINS),
-#undef DEFINE_ENUM
-
-  {NULL,           0}
-};
-#endif
-
 int luaopen_x509(lua_State *L)
 {
   auxiliar_newclass(L, "openssl.x509", x509_funcs);
@@ -1460,12 +1441,5 @@
   lua_pushliteral(L, MYVERSION);
   lua_settable(L, -3);
 
-#if OPENSSL_VERSION_NUMBER > 0x10002000L
-  lua_pushliteral(L, "check_flag");
-  lua_newtable(L);
-  auxiliar_enumerate(L, -1, check_flags_const);
-  lua_settable(L, -3);
-#endif
-
   return 1;
 }
