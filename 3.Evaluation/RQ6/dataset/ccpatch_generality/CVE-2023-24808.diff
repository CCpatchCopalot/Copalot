diff --git a/pdfio-dict.c b/pdfio-dict.c
--- a/pdfio-dict.c
+++ b/pdfio-dict.c
@@ -541,6 +541,12 @@
       _pdfioFileError(pdf, "Invalid dictionary contents.");
       break;
     }
+    else if (_pdfioDictGetValue(dict, key + 1))
+    {
+      _pdfioFileError(pdf, "Duplicate dictionary key '%s'.", key + 1);
+      return (NULL);
+    }
 
     if (!_pdfioValueRead(pdf, obj, tb, &value, depth))
diff --git a/pdfio-token.c b/pdfio-token.c
--- a/pdfio-token.c
+++ b/pdfio-token.c
@@ -129,8 +129,15 @@
   if (tb->num_tokens > 0)
   {
     // Yes, return it...
+    size_t len;				// Length of token
+
     tb->num_tokens --;
-    strncpy(buffer, tb->tokens[tb->num_tokens], bufsize - 1);
-    buffer[bufsize - 1] = '\0';
+
+    if ((len = strlen(tb->tokens[tb->num_tokens])) > (bufsize - 1))
+    {
+      *buffer = '\0';
+      return (false);
+    }
+    memcpy(buffer, tb->tokens[tb->num_tokens], len);
+    buffer[len] = '\0';
 
     PDFIO_DEBUG("_pdfioTokenGet(tb=%p, buffer=%p, bufsize=%u): Popping '%s' from stack.\n", tb, buffer, (unsigned)bufsize, buffer);
