diff --git a/tacacs-F4.0.4.28/programs.c b/tacacs-F4.0.4.28/programs.c
--- a/tacacs-F4.0.4.28/programs.c
+++ b/tacacs-F4.0.4.28/programs.c
@@ -76,7 +76,7 @@
     }
     if (STREQ(sym, "name")) {
        if (is_valid_name(data->id->NAS_name)) {
-          return(tac_strdup(data->id->username));
+          return(tac_strdup(data->id->NAS_name));
        }
     }
     if (STREQ(sym, "ip")) {
