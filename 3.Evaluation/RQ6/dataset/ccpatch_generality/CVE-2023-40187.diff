diff --git a/libfreerdp/codec/h264.c b/libfreerdp/codec/h264.c
--- a/libfreerdp/codec/h264.c
+++ b/libfreerdp/codec/h264.c
@@ -54,17 +54,12 @@
 	if (pheight % 16 != 0)
 		pheight += 16 - pheight % 16;
 	{
 		if (!h264->pYUVData[x] || !h264->pOldYUVData[x])
 			isNull = TRUE;
 	}
 
-	if (pheight == 0)
-		return FALSE;
-	if (stride == 0)
-		return FALSE;
-
 	if (isNull || (width != h264->width) || (height != h264->height) ||
 	    (stride != h264->iStride[0]))
 	{
@@ -74,7 +69,7 @@
 		h264->width = width;
 		h264->height = height;
 
 		{
 			BYTE* tmp1 = winpr_aligned_recalloc(h264->pYUVData[x], h264->iStride[x], pheight, 16);
 			BYTE* tmp2 =
@@ -420,19 +415,18 @@
 	{
 		for (UINT32 x = 0; x < 3; x++)
 		{
-			if (piDstSize[x] == 0)
-				return FALSE;
-
 			piDstStride[x] = piMainStride[0];
 			piDstSize[x] = piDstStride[x] * padDstHeight;
-			BYTE* tmp1 = winpr_aligned_recalloc(ppYUVDstData[x], piDstSize[x], 1, 16);
-			if (!tmp1)
-				return FALSE;
-			ppYUVDstData[x] = tmp1;
-			BYTE* tmp2 = winpr_aligned_recalloc(ppOldYUVDstData[x], piDstSize[x], 1, 16);
-			if (!tmp2)
-				return FALSE;
-			ppOldYUVDstData[x] = tmp2;
+			BYTE* tmp1;
+			BYTE* tmp2;
+			tmp1 = winpr_aligned_recalloc(ppYUVDstData[x], piDstSize[x], 1, 16);
+			if (tmp1)
+				ppYUVDstData[x] = tmp1;
+			tmp2 = winpr_aligned_recalloc(ppOldYUVDstData[x], piDstSize[x], 1, 16);
+			if (tmp2)
+				ppOldYUVDstData[x] = tmp2;
+			if (!tmp1 || !tmp2)
+				goto fail;
 		}
 
 		{
