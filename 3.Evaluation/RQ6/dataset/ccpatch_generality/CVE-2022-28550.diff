diff --git a/jhead.c b/jhead.c
--- a/jhead.c
+++ b/jhead.c
@@ -401,6 +401,9 @@
     // Build the exec string.  &i and &o in the exec string get replaced by input and output files.
     for (a=0;;a++){
         if (ApplyCommand[a] == '&'){
+            if (ApplyCommand[a+1] == 'i' || ApplyCommand[a+1] == 'o'){
+                if (e > PATH_MAX * 2) ErrFatal("Specified command line too long");
+            }
             if (ApplyCommand[a+1] == 'i'){
                 // Input file.
                 e += shellescape(ExecString+e, FileName);
