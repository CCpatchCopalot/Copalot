diff --git a/src/postgres/src/bin/psql/common.c b/src/postgres/src/bin/psql/common.c
--- a/src/postgres/src/bin/psql/common.c
+++ b/src/postgres/src/bin/psql/common.c
@@ -930,6 +930,12 @@
 		/* concatenate prefix and column name */
 		varname = psprintf("%s%s", pset.gset_prefix, colname);
 
+		if (VariableHasHook(pset.vars, varname))
+		{
+			/* Security: Prevent setting specially treated variables */
+			continue;
+		}
+
 		if (!PQgetisnull(result, 0, i))
 			value = PQgetvalue(result, 0, i);
diff --git a/src/postgres/src/bin/psql/variables.c b/src/postgres/src/bin/psql/variables.c
--- a/src/postgres/src/bin/psql/variables.c
+++ b/src/postgres/src/bin/psql/variables.c
@@ -360,6 +360,28 @@
 		(void) (*ahook) (current->value);
 }
 
+/*
+ * Return true iff the named variable has substitute and/or assign hook
+ * functions.
+ */
+bool
+VariableHasHook(VariableSpace space, const char *name)
+{
+	struct _variable *current;
+
+	Assert(space);
+	Assert(name);
+
+	for (current = space->next; current; current = current->next)
+	{
+		int			cmp = strcmp(current->name, name);
+
+		if (cmp == 0)
+			return (current->substitute_hook != NULL ||
+					current->assign_hook != NULL);
+		if (cmp > 0)
+			break;				/* it's not there */
+	}
+
+	return false;
+}
+
 /*
  * Convenience function to set a variable's value to "on".
diff --git a/src/postgres/src/bin/psql/variables.h b/src/postgres/src/bin/psql/variables.h
--- a/src/postgres/src/bin/psql/variables.h
+++ b/src/postgres/src/bin/psql/variables.h
@@ -90,6 +90,7 @@
 void SetVariableHooks(VariableSpace space, const char *name,
 				 VariableSubstituteHook shook,
 				 VariableAssignHook ahook);
+bool		VariableHasHook(VariableSpace space, const char *name);
 
 void		PsqlVarEnumError(const char *name, const char *value, const char *suggestions);