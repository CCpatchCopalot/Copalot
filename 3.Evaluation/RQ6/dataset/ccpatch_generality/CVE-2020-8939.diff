diff --git a/asylo/platform/host_call/trusted/host_calls.cc b/asylo/platform/host_call/trusted/host_calls.cc
--- a/asylo/platform/host_call/trusted/host_calls.cc
+++ b/asylo/platform/host_call/trusted/host_calls.cc
@@ -1325,8 +1325,8 @@
     return nullptr;
   }
 
-  memcpy(dst, result.data(),
-         std::min(static_cast<size_t>(size),
-                  static_cast<size_t>(INET6_ADDRSTRLEN)));
+  memcpy(dst, result.data(), std::min({static_cast<size_t>(size),
+                                       static_cast<size_t>(result.size()),
+                                       static_cast<size_t>(INET6_ADDRSTRLEN)}));
   return dst;
 }
 
