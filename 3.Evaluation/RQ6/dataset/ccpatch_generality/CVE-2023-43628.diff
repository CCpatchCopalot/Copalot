diff --git a/gpsd/net_ntrip.c b/gpsd/net_ntrip.c
--- a/gpsd/net_ntrip.c
+++ b/gpsd/net_ntrip.c
@@ -632,8 +632,14 @@
     unsigned i;
 
     for (i = 0; i < sizeof(lexer->outbuffer) - 2; i++) {
-        unsigned char u = *lexer->inbufptr++;
+        unsigned char u;
 
+        if (0 == lexer->inbuflen ||
+            sizeof(lexer->inbuffer) <= lexer->inbuflen) {  // paranoia
+            // nothing left to read,  ending not found
+            break;
+        }
+        u = *lexer->inbufptr++;
         lexer->outbuffer[i] = u;
         lexer->inbuflen--;
 
@@ -646,12 +652,6 @@
             i++;
             break;
         }
-
-        if (0 == lexer->inbuflen) {
-            // nothing left to read,  ending not found
-            i++;
-            break;
-        }
     }
     lexer->outbuffer[i] = '\0';  // Ensure a NUL
     lexer->outbuflen = i;
@@ -672,13 +672,14 @@
     struct gps_lexer_t *lexer = &device->lexer;
     char *ibuf = (char *)lexer->inbuffer;
     char *obuf = (char *)lexer->outbuffer;
+    bool got_header;
 
     GPSD_LOG(LOG_PROG, errout,
              "NTRIP: ntrip_stream_get_parse(fd %d)\n", dsock);
     lexer_init(lexer, &device->context->errout);
     /* We expect the header comes in as one TCP packet.
      * dsock is still blocking, so get exactly 1024 bytes */
-    while (-1 == (read_ret = read(dsock, ibuf, 1024))) {
+    while (0 >= (read_ret = read(dsock, ibuf, 1024))) {
         if (EINTR == errno) {
             continue;
         }
@@ -688,7 +689,7 @@
         return -1;
     }
     ibuf[read_ret] = '\0';   // Make a nice NUL terminated string.
-    lexer->inbuflen = read_ret;
+    lexer->inbuflen = (size_t)read_ret;
     lexer_getline(lexer);
     GPSD_LOG(LOG_IO, errout,
              "NTRIP: lexer_getline() >%s<\n",
@@ -746,7 +747,8 @@
      *
      */
 
-    while (1) {
+    got_header = false;
+    while (0 < lexer->inbuflen) {
         lexer_getline(lexer);
         GPSD_LOG(LOG_IO, errout,
                  "NTRIP: lexer_getline() >%s<\n",
@@ -766,9 +768,17 @@
         if (0 == strncmp(obuf, NTRIP_BR, sizeof(NTRIP_BR))) {
             // done
+            got_header = true;
             break;
         }
     }
+    if (false == got_header) {
+        GPSD_LOG(LOG_WARN, errout,
+                 "NTRIP: did not get end of headers.\n");
+        /* do something about it? If we are not chunked it'll work out
+         * anyway. */
+    }
+
     opts = fcntl(dsock, F_GETFL);
 
     if (-1 == opts) {
@@ -782,7 +792,8 @@
     GPSD_LOG(LOG_IO, errout,
              "NTRIP: ntrip_stream_get_parse(), %zu leftover bytes\n",
              lexer->inbuflen);
-    if (0 == lexer->inbuflen) {
+    if (0 == lexer->inbuflen ||
+        sizeof(lexer->inbuffer) <= lexer->inbuflen) {  // paranoia
         packet_reset(lexer);
     } else {
         // The "leftover" is the start of the first chunk.
