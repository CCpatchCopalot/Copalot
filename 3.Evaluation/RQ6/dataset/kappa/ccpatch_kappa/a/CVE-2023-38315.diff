diff --git a/src/http_microhttpd.c b/src/http_microhttpd.c
--- a/src/http_microhttpd.c
+++ b/src/http_microhttpd.c
@@ -522,6 +522,11 @@
 
 	// Check for authdir
 	if (check_authdir_match(url, config->authdir)) {
 		tok = MHD_lookup_connection_value(connection, MHD_GET_ARGUMENT_KIND, "tok");
+
+		if (tok == NULL) {
+			return send_error(connection, 403);
+		}
+
 		debug(LOG_DEBUG, "client->token=%s tok=%s ", client->token, tok );
 
 		//Check if token (tok) or hash_id (hid) mode
