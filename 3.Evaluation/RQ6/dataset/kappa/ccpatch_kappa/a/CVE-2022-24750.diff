diff --git a/winvnc/winvnc/vncproperties.cpp b/winvnc/winvnc/vncproperties.cpp
index 8880629..36a31b3 100644
--- a/winvnc/winvnc/vncproperties.cpp
+++ b/winvnc/winvnc/vncproperties.cpp
@@ -43,6 +43,7 @@
 #include "vncConnDialog.h"
 
 #include "Localization.h" // ACT : Add localization on messages
+#include "shlwapi.h"
 
 //extern HINSTANCE g_hInst;
 
@@ -1368,6 +1369,8 @@ vncProperties::DialogProc(HWND hwnd,
 				{
 					TCHAR szPlugin[MAX_PATH];
 					GetDlgItemText(hwnd, IDC_PLUGINS_COMBO, szPlugin, MAX_PATH);
+					PathStripPathA(szPlugin);
+
 					if (!_this->m_server->GetDSMPluginPointer()->IsLoaded())
 						_this->m_server->GetDSMPluginPointer()->LoadPlugin(szPlugin, false);
 					else