diff --git a/drivers/net/wireless/microchip/wilc1000/cfg80211.c b/drivers/net/wireless/microchip/wilc1000/cfg80211.c
--- a/drivers/net/wireless/microchip/wilc1000/cfg80211.c
+++ b/drivers/net/wireless/microchip/wilc1000/cfg80211.c
@@ -987,6 +987,13 @@
 		/* the number of bytes following the final 'elem' member */
 		elem_size = le16_to_cpu(ch_list->attr_len) -
 			(sizeof(*ch_list) - sizeof(struct wilc_attr_entry));
+
 		for (i = 0; i < elem_size;) {
 			e = (struct wilc_ch_list_elem *)(ch_list->elem + i);
+
+			i += sizeof(*e);
+			if (i > elem_size)
+				break;
+
+			i += e->no_of_channels;
 			if (i > elem_size)
 				break;
@@ -994,7 +1001,6 @@
 			if (e->op_class == WILC_WLAN_OPERATING_CLASS_2_4GHZ) {
 				memset(e->ch_list, sta_ch, e->no_of_channels);
 				break;
 			}
-			i += sizeof(*e) + e->no_of_channels;
 		}
 	}
 }
