diff --git a/src/main.c b/src/main.c
--- a/src/main.c
+++ b/src/main.c
@@ -111,7 +111,7 @@
         bool enable_debug;
         bool enable_trace;
     } optarg;
-    const char *argv_out[argc];
+    const char *argv_out[argc+1];
 
     memset(&optarg, 0, sizeof(optarg));
diff --git a/tests/app/5gc-init.c b/tests/app/5gc-init.c
--- a/tests/app/5gc-init.c
+++ b/tests/app/5gc-init.c
@@ -37,7 +37,7 @@
     bool user_config = false;
     int i = 0;
 
-    for (i = 0; argv[i]; i++) {
+    for (i = 0; argv[i] && i < OGS_ARG_MAX-3; i++) {
         if (strcmp("-c", argv[i]) == 0) {
             user_config = true; 
diff --git a/tests/app/app-init.c b/tests/app/app-init.c
--- a/tests/app/app-init.c
+++ b/tests/app/app-init.c
@@ -42,7 +42,7 @@
     bool user_config = false;
     int i = 0;
 
-    for (i = 0; argv[i]; i++) {
+    for (i = 0; argv[i] && i < OGS_ARG_MAX-3; i++) {
         if (strcmp("-c", argv[i]) == 0) {
             user_config = true;
diff --git a/tests/app/epc-init.c b/tests/app/epc-init.c
--- a/tests/app/epc-init.c
+++ b/tests/app/epc-init.c
@@ -33,7 +33,7 @@
     bool user_config = false;
     int i = 0;
 
-    for (i = 0; argv[i]; i++) {
+    for (i = 0; argv[i] && i < OGS_ARG_MAX-3; i++) {
         if (strcmp("-c", argv[i]) == 0) {
             user_config = true; 
diff --git a/tests/common/application.c b/tests/common/application.c
--- a/tests/common/application.c
+++ b/tests/common/application.c
@@ -27,7 +27,7 @@
     bool user_config;
 
     /* '-f sample-XXXX.conf -e error' is always added */
-    const char *argv_out[argc+4], *new_argv[argc+4];
+    const char *argv_out[argc+5], *new_argv[argc+5];
     int argc_out;
 
     char conf_file[OGS_MAX_FILEPATH_LEN];
