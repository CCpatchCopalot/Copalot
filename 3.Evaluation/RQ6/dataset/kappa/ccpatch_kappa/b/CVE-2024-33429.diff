diff --git a/src/afilter/conv.c b/src/afilter/conv.c
--- a/src/afilter/conv.c
+++ b/src/afilter/conv.c
@@ -103,6 +103,12 @@
 	if (r != 0)
 		return PHI_ERR;
 
+	// Allow no more than 16MB per 1 second of 64-bit 7.1 audio: 0x00ffffff/(64/8*8)=262143
+	if (c->fo.rate > 262143) {
+		errlog(t, "too large sample rate: %u", c->fo.rate);
+		return PHI_ERR;
+	}
+
 	uint out_ch = c->fo.channels & PHI_PCM_CHMASK;
 	c->out_samp_size = pcm_size(c->fo.format, out_ch);
diff --git a/src/afilter/soxr.h b/src/afilter/soxr.h
--- a/src/afilter/soxr.h
+++ b/src/afilter/soxr.h
@@ -74,6 +74,10 @@
 	if (inpcm->channels != outpcm->channels)
 		return -1;
 
+	// Allow no more than 16MB per 1 second of 64-bit 7.1 audio: 0x00ffffff/(64/8*8)=262143
+	if (outpcm->rate > 262143)
+		return -1;
+
 	int itype = _ffsoxr_getfmt(inpcm->format, inpcm->interleaved);
 	int otype = _ffsoxr_getfmt(outpcm->format, outpcm->interleaved);
 	if (itype == -1 || otype == -1)
