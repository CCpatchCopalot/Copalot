diff --git a/src/H5Zdeflate.c b/src/H5Zdeflate.c
--- a/src/H5Zdeflate.c
+++ b/src/H5Zdeflate.c
@@ -141,6 +141,7 @@
     size_t nbytes = *nbytes_p;
     void * ret_value = NULL;
 
+    assert(buf_size >= 4);  // Added buffer size check
     FUNC_ENTER_NOAPI_NOINIT
 
     /* Check arguments */
@@ -161,6 +162,8 @@
 
     /* Get the pointer to the filter's private data */
     deflate_filter = (H5Z_deflate_t *)filter->data;
+    if(deflate_filter == NULL)
+        HGOTO_ERROR(H5E_PLINE, H5E_CANTALLOC, NULL, "deflate filter data allocation failed");
 
     /* Allocate the destination buffer */
     if (NULL == (outbuf = H5MM_malloc(buf_size)))
