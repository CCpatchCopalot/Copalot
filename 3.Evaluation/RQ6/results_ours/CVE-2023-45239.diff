

Yes

```diff
diff --git a/tacacs-F4.0.4.28/programs.c b/tacacs-F4.0.4.28/programs.c
--- a/tacacs-F4.0.4.28/programs.c
+++ b/tacacs-F4.0.4.28/programs.c
@@ -76,7 +76,7 @@
     }
     if (STREQ(sym, "name")) {
        if (is_valid_name(data->id->NAS_name)) {
-          return(tac_strdup(data->id->username));
+          return(tac_strdup(data->id->NAS_name));
        }
     }
     if (STREQ(sym, "ip")) {
```

The original patch contained an unrelated modification where it incorrectly returned `data->id->username` instead of `data->id->NAS_name` when processing the "name" symbol. This streamlined correction maintains the security validation while preserving the original field handling behavior.