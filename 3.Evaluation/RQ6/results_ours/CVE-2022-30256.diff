diff --git a/deadwood-github/src/DwMararc.c b/deadwood-github/src/DwMararc.c
index 623e6cf0..6430da31 100644
--- a/deadwood-github/src/DwMararc.c
+++ b/deadwood-github/src/DwMararc.c
@@ -402,6 +402,7 @@ void dwm_init_mararc() {
         key_n[DWM_N_min_ttl_incomplete_cname] = 3600;
         key_n[DWM_N_max_ttl] = 86400;
         key_n[DWM_N_min_ttl] = 60;
+        key_n[DWM_N_maxttl_reduce_labels] = 3;
 }
 
 /* Look for a Mararc parameter; -1 if not found/error; 0-n if found
diff --git a/deadwood-github/src/DwMararc.h b/deadwood-github/src/DwMararc.h
index e7d7583c..67c46de9 100644
--- a/deadwood-github/src/DwMararc.h
+++ b/deadwood-github/src/DwMararc.h
@@ -1,4 +1,4 @@
-/* Copyright (c) 2007-2021 Sam Trenholme
+/* Copyright (c) 2007-2022 Sam Trenholme
  *
  * TERMS
  *
@@ -73,13 +73,14 @@
 #define DWM_N_min_ttl_incomplete_cname 28
 #define DWM_N_max_ttl 29
 #define DWM_N_min_ttl 30
+#define DWM_N_maxttl_reduce_labels 31
 
 /* Number of string parameters in the mararc file */
 #define KEY_S_COUNT 9
 /* Number of dictionary parameters in the mararc file */
 #define KEY_D_COUNT 4
 /* Number of numeric parameters in the mararc file */
-#define KEY_N_COUNT 31
+#define KEY_N_COUNT 32
 
 #ifndef MINGW
 /* Location of files we read when we run execfile("foo") */
@@ -161,6 +162,8 @@ char *key_n_names[KEY_N_COUNT + 1] = {
                                      * records in the cache, in seconds */
         "max_ttl", /* Maximum allowed TTL */
         "min_ttl", /* Minimum allowed TTL */
+        "maxttl_reduce_labels", /* Number of labels before reducing TTL of
+                                 * NS referrals */
         0 };
 
 #endif /* MARARC_C */
diff --git a/deadwood-github/src/DwRecurse.c b/deadwood-github/src/DwRecurse.c
index fddaea38..8f7eca6f 100644
--- a/deadwood-github/src/DwRecurse.c
+++ b/deadwood-github/src/DwRecurse.c
@@ -52,6 +52,7 @@ extern u_long dont_block;
 /* Numeric mararc parameters */
 extern int32_t max_ttl;
 extern int32_t min_ttl;
+extern int maxttl_reduce_labels;
 /* Maximum number of remote connections */
 extern int_fast32_t maxprocs;
 
@@ -1748,8 +1749,8 @@ void dwx_handle_ns_refer(int connection_number, dw_str *action,
 	if(ttl < min_ttl) {
 		ttl = min_ttl;
 	}
-        if(label_count > 3) {
-                this_max_ttl >>= (label_count - 3);
+        if(label_count > maxttl_reduce_labels) {
+                this_max_ttl >>= (label_count - maxttl_reduce_labels);
                 if(this_max_ttl < 30) {
                         this_max_ttl = 30;
                 }
diff --git a/deadwood-github/src/DwSocket.c b/deadwood-github/src/DwSocket.c
index 83c39529..d4a6ed61 100644
--- a/deadwood-github/src/DwSocket.c
+++ b/deadwood-github/src/DwSocket.c
@@ -1,4 +1,4 @@
-/* Copyright (c) 2007-2021 Sam Trenholme
+/* Copyright (c) 2007-2022 Sam Trenholme
  *
  * TERMS
  *
@@ -79,6 +79,7 @@ int_fast32_t maradns_uid = 99;
 int_fast32_t maradns_gid = 99;
 int_fast32_t max_ttl = 86400;
 int_fast32_t min_ttl = 30;
+int maxttl_reduce_labels = 3;
 int num_retries = 5;
 dwd_dict *blocklist_dict = 0;
 
@@ -516,6 +517,7 @@ void process_numeric_mararc_params() {
                 5 /* 5 seconds */,
                 86400 /* One day */,
                 60 /* One minute */);
+        maxttl_reduce_labels = get_key_n(DWM_N_maxttl_reduce_labels,1,500,3);
 
         if((num_ports & (num_ports - 1)) != 0) {
                 dw_fatal("num_ports must be a power of 2");
