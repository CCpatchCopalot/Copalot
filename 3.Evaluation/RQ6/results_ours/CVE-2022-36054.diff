diff --git a/os/net/ipv6/uipbuf.c b/os/net/ipv6/uipbuf.c
index 59466b37630..c9d769b231f 100644
--- a/os/net/ipv6/uipbuf.c
+++ b/os/net/ipv6/uipbuf.c
@@ -118,6 +118,9 @@ uipbuf_get_next_header(uint8_t *buffer, uint16_t size, uint8_t *protocol, bool s
 
   /* Check if the buffer is large enough for the next header */
   if(uip_is_proto_ext_hdr(*protocol)) {
+    if(curr_hdr_len + sizeof(struct uip_ext_hdr) > size) {
+      return NULL;
+    }
     next_ext = (struct uip_ext_hdr *)next_header;
     next_hdr_len = (next_ext->len << 3) + 8;
   } else {
