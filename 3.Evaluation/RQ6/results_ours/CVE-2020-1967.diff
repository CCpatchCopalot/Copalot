diff --git a/ssl/t1_lib.c b/ssl/t1_lib.c
index b9b3a602526f8..79f66601be31c 100644
--- a/ssl/t1_lib.c
+++ b/ssl/t1_lib.c
@@ -2259,7 +2259,7 @@ static int tls1_check_sig_alg(SSL *s, X509 *x, int default_nid)
         sigalg = use_pc_sigalgs
                  ? tls1_lookup_sigalg(s->s3.tmp.peer_cert_sigalgs[i])
                  : s->shared_sigalgs[i];
-        if (sig_nid == sigalg->sigandhash)
+        if (sigalg != NULL && sig_nid == sigalg->sigandhash)
             return 1;
     }
     return 0;
