diff --git a/tensorflow/lite/kernels/internal/utils/sparsity_format_converter.cc b/tensorflow/lite/kernels/internal/utils/sparsity_format_converter.cc
--- a/tensorflow/lite/kernels/internal/utils/sparsity_format_converter.cc
+++ b/tensorflow/lite/kernels/internal/utils/sparsity_format_converter.cc
@@ -282,6 +282,7 @@
   block_size_.resize(block_map_.size());
   for (int i = 0; i < original_rank; i++) {
     if (block_dim < block_map_.size() && block_map_[block_dim] == i) {
+      if (original_rank + block_dim < traversal_order_.size()) {
       int orig_dim = traversal_order_[original_rank + block_dim];
       block_size_[block_dim] = dense_size[orig_dim];
       blocked_shape_[i] = dense_shape_[i] / dense_size[orig_dim];
@@ -335,6 +336,7 @@
     const auto& array_indices = dim_metadata_[metadata_idx + 1];
     for (int i = array_segments[prev_idx]; i < array_segments[prev_idx + 1];
          i++) {
+      if (i < array_indices.size() && level < indices.size()) {
       indices[level] = array_indices[i];
       Populate(src_data, indices, level + 1, i, src_data_ptr, dest_data);
     }