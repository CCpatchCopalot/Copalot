diff --git a/libde265/decctx.cc b/libde265/decctx.cc
index 223a6aaf..350f7e7a 100644
--- a/libde265/decctx.cc
+++ b/libde265/decctx.cc
@@ -582,6 +582,9 @@
   std::shared_ptr<pic_parameter_set> new_pps = std::make_shared<pic_parameter_set>();
 
   bool success = new_pps->read(&reader,this);
+  if (!success) {
+    return DE265_WARNING_PPS_HEADER_INVALID;
+  }
 
   if (param_pps_headers_fd>=0) {
     new_pps->dump(param_pps_headers_fd);