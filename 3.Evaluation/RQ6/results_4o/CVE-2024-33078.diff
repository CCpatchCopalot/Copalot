diff --git a/src/codec/tags/VideoSequence.cpp b/src/codec/tags/VideoSequence.cpp
index 01e92e4ead..4349b19fc0 100644
--- a/src/codec/tags/VideoSequence.cpp
+++ b/src/codec/tags/VideoSequence.cpp
@@ -112,7 +112,7 @@
   auto length = stream->readEncodedUint32();
   auto bytes = stream->readBytes(length);
   // must check whether the bytes is valid. otherwise memcpy will crash.
-  if (length == 0 || stream->context->hasException()) {
+  if (length == 0 || length > bytes.length() || stream->context->hasException()) {
     return nullptr;
   }
   auto data = new (std::nothrow) uint8_t[length];
diff --git a/src/codec/utils/NALUReader.cpp b/src/codec/utils/NALUReader.cpp
index 6d39e62b6f..77ef4beef2 100644
--- a/src/codec/utils/NALUReader.cpp
+++ b/src/codec/utils/NALUReader.cpp
@@ -24,7 +24,7 @@
   auto length = stream->readEncodedUint32();
   auto bytes = stream->readBytes(length);
   // must check whether the bytes is valid. otherwise memcpy will crash.
-  if (length == 0 || stream->context->hasException()) {
+  if (length == 0 || length > bytes.length() || stream->context->hasException()) {
     return nullptr;
   }
   auto data = new (std::nothrow) uint8_t[length + 4];