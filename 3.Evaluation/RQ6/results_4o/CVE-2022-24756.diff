diff --git a/core/src/dird/auth_pam.cc b/core/src/dird/auth_pam.cc
index 0f08fb2b3e7..d1483925936 100644
--- a/core/src/dird/auth_pam.cc
+++ b/core/src/dird/auth_pam.cc
@@ -189,34 +189,7 @@
     return false;
   }
 
-  err = pam_set_item(pamh, PAM_RUSER, username);
-  if (err != PAM_SUCCESS) {
-    Dmsg1(debuglevel, "PAM set_item failed: %s\n", pam_strerror(pamh, err));
-    return false;
-  }
-
-  err = pam_authenticate(pamh, 0);
-  if (err != PAM_SUCCESS) {
-    Dmsg1(debuglevel, "PAM authentication failed: %s\n",
-          pam_strerror(pamh, err));
-    return false;
-  }
-
-#if defined(__sun)
-  void* data;
-#else
-  const void* data;
-#endif
-  err = pam_get_item(pamh, PAM_USER, &data);
-  if (err != PAM_SUCCESS) {
-    Dmsg1(debuglevel, "PAM get_item failed: %s\n", pam_strerror(pamh, err));
-    return false;
-  } else {
-    if (data) {
-      const char* temp_str = static_cast<const char*>(data);
-      authenticated_username = temp_str;
-    }
-  }
+  err = DoPamAuth(pamh, username, authenticated_username);
 
   if (pam_end(pamh, err) != PAM_SUCCESS) {
     Dmsg1(debuglevel, "PAM end failed: %s\n", pam_strerror(pamh, err));