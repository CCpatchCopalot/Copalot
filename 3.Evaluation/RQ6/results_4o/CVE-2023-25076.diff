diff --git a/src/address.c b/src/address.c
index 9a544a5b..2811b7ef 100644
--- a/src/address.c
+++ b/src/address.c
@@ -148,6 +148,8 @@ new_address(const char *hostname_or_ip) {
     if (hostname_or_ip[0] == '[' &&
             (port = strchr(hostname_or_ip, ']')) != NULL) {
         len = (size_t)(port - hostname_or_ip - 1);
+        if (len >= INET6_ADDRSTRLEN)
+            return NULL;
 
         /* inet_pton() will not parse the IP correctly unless it is in a
diff --git a/tests/bad_dns_request_test b/tests/bad_dns_request_test
index d37743fc..7a0ea07f 100755
--- a/tests/bad_dns_request_test
+++ b/tests/bad_dns_request_test
@@ -35,6 +35,11 @@ my $bad_requests = [
         request => "GET / HTTP/1.1\r\nHost: \0example.com\r\n\r\n",
         client => \&http_client,
     },
+    {
+        # Exceed hostname buffer size
+        request => "GET / HTTP/1.1\r\nHost: [" . 'long.' x 60 . "example.com]\r\n\r\n",
+        client => \&http_client,
+    },
     {
         # Test client aborting connection before DNS response received
         request => "GET / HTTP/1.1\r\nHost: example.com\r\n\r\n",