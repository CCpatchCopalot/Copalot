diff --git a/tiny_dng_loader.h b/tiny_dng_loader.h
--- a/tiny_dng_loader.h
+++ b/tiny_dng_loader.h
@@ -5475,8 +5475,17 @@
         }
 
         int w = 0, h = 0, components = 0;
+
+        // Check if data is in valid range.
+        if ((sr.tell() + data_offset + static_cast<uint32_t>(jpeg_len)) >= sr.size()) {
+          if (err) {
+            (*err) += "Invalid JPEG image data size.\n";
+          }
+          return false;
+        }
+
         unsigned char* decoded_image = stbi_load_from_memory(
-            sr.data() + data_offset, static_cast<int>(jpeg_len), &w, &h,
+            sr.data() + data_offset, static_cast<uint32_t>(jpeg_len), &w, &h,
             &components, /* desired_channels */ components_info);
         TINY_DNG_ASSERT(decoded_image, "Could not decode JPEG image.");
 