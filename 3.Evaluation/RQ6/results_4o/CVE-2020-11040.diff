diff --git a/libfreerdp/codec/clear.c b/libfreerdp/codec/clear.c
--- a/libfreerdp/codec/clear.c
+++ b/libfreerdp/codec/clear.c
@@ -146,6 +146,8 @@
 		return FALSE;
 	}
 
+	if (Stream_GetRemainingLength(s) < 1)
+		return FALSE;
 	Stream_Read_UINT8(s, paletteCount);
 	bitmapDataOffset = 1 + (paletteCount * 3);
 
@@ -155,6 +157,9 @@
 		return FALSE;
 	}
 
+	if (Stream_GetRemainingLength(s) < 3ULL * paletteCount)
+		return FALSE;
+
 	for (i = 0; i < paletteCount; i++)
 	{
 		BYTE r, g, b;