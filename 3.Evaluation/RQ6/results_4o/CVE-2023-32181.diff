diff --git a/lib/getfilecontents.c b/lib/getfilecontents.c
--- a/lib/getfilecontents.c
+++ b/lib/getfilecontents.c
@@ -265,11 +265,12 @@
   }
   ef->delimiter = *delim;
 
-  while (fgets(buf, sizeof(buf), kf)) {
+  while (fgets(buf, BUFSIZ-1, kf)) {
     char *p, *name, *data = NULL;
     bool quote_seen = false, delim_seen = false;
     char *org_buf __attribute__ ((__cleanup__(free_buffer))) = strdup(buf);
 
+    buf[BUFSIZ-1] = '\0';
     line++;
     last_scanned_line_nr = line;
diff --git a/lib/libeconf.c b/lib/libeconf.c
--- a/lib/libeconf.c
+++ b/lib/libeconf.c
@@ -542,6 +542,7 @@
       char *value_string = buf;
 
       strncpy(buf,key_file->file_entry[i].comment_before_key,BUFSIZ-1);
+      buf[BUFSIZ-1] = '\0';
       while ((line = strsep(&value_string, "\n")) != NULL) {
 	fprintf(kf, "%c%s\n",
 		key_file->comment,
@@ -566,6 +567,7 @@
       char *value_string = buf;
 
       strncpy(buf,key_file->file_entry[i].comment_after_value,BUFSIZ-1);
+      buf[BUFSIZ-1] = '\0';
       while ((line = strsep(&value_string, "\n")) != NULL) {
 	fprintf(kf, " %c%s\n",
diff --git a/lib/libeconf_ext.c b/lib/libeconf_ext.c
--- a/lib/libeconf_ext.c
+++ b/lib/libeconf_ext.c
@@ -82,6 +82,7 @@
 
   if (value_string!=NULL) {
     strncpy(buf,value_string,BUFSIZ-1);
+    buf[BUFSIZ-1] = '\0';
     free(value_string);
     value_string = trim(buf);
 
