diff --git a/postsrsd.c b/postsrsd.c
--- a/postsrsd.c
+++ b/postsrsd.c
@@ -689,6 +689,12 @@
                     while ((line = fgets(linebuf, sizeof(linebuf), fp_read)))
                     {
                         char *token;
+                        alarm(0);
+                        if (strlen(line) >= sizeof(linebuf) - 1)
+                        {
+                            fprintf(fp_write, "500 Invalid request\n");
+                            fflush(fp_write);
+                            return EXIT_FAILURE;
+                        }
                         token = strtok(line, " \r\n");
                         if (token == NULL || strcmp(token, "get") != 0)
diff --git a/run_postsrsd_tests.bats b/run_postsrsd_tests.bats
--- a/run_postsrsd_tests.bats
+++ b/run_postsrsd_tests.bats
@@ -180,4 +180,10 @@
 	echo>&9 "get encoding%error@otherdomain.com"
 	read<&9 line
 	[[ "$line" =~ ^500 ]]
+	exec 9<>/dev/tcp/127.0.0.1/10001
+	# Try to overflow the input buffer
+	echo>&9 "get too_long@`fillchar 1024 a`.com"
+	read<&9 line
+	[[ "$line" =~ ^500 ]]
 }
+