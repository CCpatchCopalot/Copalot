diff --git a/usr.sbin/smtpd/lka_filter.c b/usr.sbin/smtpd/lka_filter.c
index 21b10ce1033b..d1194254d8df 100644
--- a/usr.sbin/smtpd/lka_filter.c
+++ b/usr.sbin/smtpd/lka_filter.c
@@ -600,11 +600,6 @@ filter_session_io(struct io *io, int evt, void *arg)
 		filter_data(fs->id, line);
 
 		goto nextline;
-
-	case IO_DISCONNECTED:
-		io_free(fs->io);
-		fs->io = NULL;
-		break;
 	}
 }
 
This diff shows the removal of the IO_DISCONNECTED case handling which previously freed the I/O channel and set the pointer to NULL. The vulnerability was caused by improper maintenance of this I/O channel, leading to a NULL pointer dereference when the disconnected state was handled prematurely.