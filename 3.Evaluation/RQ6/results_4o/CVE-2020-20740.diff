diff --git a/pdf.c b/pdf.c
index 03c674e..c4ed49b 100644
--- a/pdf.c
+++ b/pdf.c
@@ -190,13 +190,16 @@
 
 void pdf_get_version(FILE *fp, pdf_t *pdf)
 {
-    char *header, *c;
-
-    header = get_header(fp);
+    char *header = get_header(fp);
 
-    /* Locate version string start and make sure we dont go past header */
+    /* Locate version string start and make sure we dont go past header
+     * The format is %PDF-M.m, where 'M' is the major number and 'm' minor.
+     */
+    const char *c;
     if ((c = strstr(header, "%PDF-")) && 
-        (c + strlen("%PDF-M.m") + 2))
+        ((c + 6)[0] == '.') && // Separator
+        isdigit((c + 5)[0]) && // Major number
+        isdigit((c + 7)[0]))   // Minor number
     {
         pdf->pdf_major_version = atoi(c + strlen("%PDF-"));
         pdf->pdf_minor_version = atoi(c + strlen("%PDF-M."));