diff --git a/src/http_microhttpd.c b/src/http_microhttpd.c
index cbccee66..9fcc63f4 100644
--- a/src/http_microhttpd.c
+++ b/src/http_microhttpd.c
@@ -1216,6 +1216,10 @@ static int preauthenticated(struct MHD_Connection *connection, const char *url,
 		redirect_url = safe_calloc(REDIRECT_URL);
 		redirect_url = get_redirect_url(connection);
 
+		if (redirect_url == NULL) {
+			return send_error(connection, 403);
+		}
+
 		if (!try_to_authenticate(connection, client, host, url)) {
 			// user used an invalid token, redirect to splashpage but hold query "redir" intact
 			originurl = safe_calloc(REDIRECT_URL_ENC_BUF);