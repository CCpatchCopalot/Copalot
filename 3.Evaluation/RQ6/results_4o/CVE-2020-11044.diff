diff --git a/libfreerdp/core/orders.c b/libfreerdp/core/orders.c
--- a/libfreerdp/core/orders.c
+++ b/libfreerdp/core/orders.c
@@ -2161,7 +2161,7 @@
 	Stream_Read_UINT16(s, bitmapData->height); /* height (2 bytes) */
 	Stream_Read_UINT32(s, new_len);            /* length (4 bytes) */
 
-	if (Stream_GetRemainingLength(s) < new_len)
+	if ((new_len == 0) || (Stream_GetRemainingLength(s) < new_len))
 		goto fail;
 
 	new_data = (BYTE*)realloc(bitmapData->data, new_len);