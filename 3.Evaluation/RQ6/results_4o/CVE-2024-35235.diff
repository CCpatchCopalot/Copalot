diff --git a/cups/http-addr.c b/cups/http-addr.c
index 698b15be5..8f5f75885 100644
--- a/cups/http-addr.c
+++ b/cups/http-addr.c
@@ -244,7 +244,6 @@ httpAddrListen(http_addr_t *addr,	// I - Address to bind to
 
     // Restore the umask and fix permissions...
     umask(mask);
-    chmod(addr->un.sun_path, 0140777);
   }
   else
diff --git a/scheduler/conf.c b/scheduler/conf.c
index 95abf8292..d5e0792f2 100644
--- a/scheduler/conf.c
+++ b/scheduler/conf.c
@@ -3152,6 +3152,26 @@ read_cupsd_conf(cups_file_t *fp)	/* I - File to read from */
       cupsd_listener_t	*lis;		/* New listeners array */
 
 
+     /*
+      * If we are launched on-demand, do not use domain sockets from the config
+      * file.  Also check that the domain socket path is not too long...
+      */
+
+#ifdef HAVE_ONDEMAND
+      if (*value == '/' && OnDemand)
+      {
+        if (strcmp(value, CUPS_DEFAULT_DOMAINSOCKET))
+          cupsdLogMessage(CUPSD_LOG_INFO, "Ignoring %s address %s at line %d - only using domain socket from launchd/systemd.", line, value, linenum);
+        continue;
+      }
+#endif // HAVE_ONDEMAND
+
+      if (*value == '/' && strlen(value) > (sizeof(addr->addr.un.sun_path) - 1))
+      {
+        cupsdLogMessage(CUPSD_LOG_INFO, "Ignoring %s address %s at line %d - too long.", line, value, linenum);
+        continue;
+      }
+
      /*
       * Get the address list...
       */