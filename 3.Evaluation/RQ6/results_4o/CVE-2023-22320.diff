diff --git a/source/am.h b/source/am.h
--- a/source/am.h
+++ b/source/am.h
@@ -248,6 +248,7 @@
     struct url url; /* parsed/normalized request url (split in values) */
     char *normalized_url; /* normalized request url */
     char *overridden_url; /* normalized/overridden request url */
+    char *goto_url; /* URL based on overridden_url but using orig_url only for path information */
     char *normalized_url_pathinfo;
     char *overridden_url_pathinfo;
diff --git a/source/process.c b/source/process.c
--- a/source/process.c
+++ b/source/process.c
@@ -365,6 +365,12 @@
         return AM_FAIL;
     }
 
+    r->goto_url = get_goto_url(r->orig_url, &request_url);
+    if (r->goto_url == NULL) {
+        AM_LOG_ERROR(r->instance_id, "%s failed to make goto_url", thisfunc);
+        return AM_FAIL;
+    }
+
     if (ISVALID(r->path_info) && r->conf->path_info_ignore) {
         r->overridden_url_pathinfo = remove_pathinfo_from_url(&request_url, r->path_info);
         if (r->overridden_url_pathinfo == NULL) {
@@ -381,11 +387,11 @@
 
     AM_LOG_DEBUG(r->instance_id, "%s \nmethod: %s \noriginal url: %s"
             "\nproto: %s\nhost: %s\nport: %d\npath: %s\nquery: %s\ncomplete: %s\noverridden: %s"
-            "\npathinfo: %s"
+            "\ngoto_url: %s\npathinfo: %s"
             "\nnormalized (pathinfo removed): %s\noverridden (pathinfo removed): %s", thisfunc,
             am_method_num_to_str(r->method), r->orig_url,
             r->url.proto, r->url.host, r->url.port, r->url.path, r->url.query, r->normalized_url,
-            r->overridden_url, LOGEMPTY(r->path_info),
+            r->overridden_url, r->goto_url, LOGEMPTY(r->path_info),
             LOGEMPTY(r->normalized_url_pathinfo), LOGEMPTY(r->overridden_url_pathinfo));
 
     if (r->method == AM_REQUEST_POST && !ISVALID(r->content_type)) {
@@ -1995,7 +2001,7 @@
     if (map_sz > 0 && map != NULL) {
         am_config_map_t *m = (valid_idx >= map_sz) ? &map[0] : &map[valid_idx];
         if (add_goto_value) {
-            char *goto_encoded = url_encode(r->overridden_url);
+            char *goto_encoded = url_encode(r->goto_url);
 
             if (r->conf->cdsso_enable &&
                     ISVALID(r->conf->url_redirect_param) &&
@@ -2606,7 +2612,7 @@
                     }
 
                 } else if (ISVALID(r->conf->access_denied_url)) {
-                    char *goto_encoded = url_encode(r->overridden_url);
+                    char *goto_encoded = url_encode(r->goto_url);
 
                     am_asprintf(&url, "%s%s%s=%s", r->conf->access_denied_url,
diff --git a/source/utility.c b/source/utility.c
--- a/source/utility.c
+++ b/source/utility.c
@@ -549,7 +549,7 @@
         }
     }
 
-    d = strdup(url->path);
+    d = url_decode(url->path);
     if (d == NULL) {
         url->error = AM_ENOMEM;
         return AM_ERROR;
@@ -2017,7 +2017,7 @@
 void am_request_free(am_request_t *r) {
     if (r != NULL) {
         AM_FREE(r->normalized_url, r->overridden_url, r->normalized_url_pathinfo,
-                r->overridden_url_pathinfo, r->token,
+                r->overridden_url_pathinfo, r->token, r->goto_url,
                 r->client_ip, r->client_host, r->post_data, r->post_data_fn,
                 r->session_info.s1, r->session_info.si, r->session_info.sk);
         delete_am_policy_result_list(&r->pattr);