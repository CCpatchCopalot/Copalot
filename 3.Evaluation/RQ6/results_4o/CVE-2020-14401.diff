diff --git a/libvncserver/scale.c b/libvncserver/scale.c
--- a/libvncserver/scale.c
+++ b/libvncserver/scale.c
@@ -210,7 +210,7 @@
              default:
                /* fixme: endianness problem? */
                for (z = 0; z < bytesPerPixel; z++)
-                 pixel_value += (srcptr2[z] << (8 * z));
+                 pixel_value += ((unsigned long)srcptr2[z] << (8 * z));
                 break;
               }
               /*