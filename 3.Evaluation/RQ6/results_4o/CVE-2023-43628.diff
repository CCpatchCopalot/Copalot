diff --git a/gpsd/net_ntrip.c b/gpsd/net_ntrip.c
index 58cc7e042..cc7ab003e 100644
--- a/gpsd/net_ntrip.c
+++ b/gpsd/net_ntrip.c
@@ -632,8 +632,14 @@ static void lexer_getline(struct gps_lexer_t *lexer)
     unsigned i;
 
     for (i = 0; i < sizeof(lexer->outbuffer) - 2; i++) {
-        unsigned char u = *lexer->inbufptr++;
+        unsigned char u;
 
+        if (0 == lexer->inbuflen ||
+            sizeof(lexer->inbuffer) <= lexer->inbuflen) {  // paranoia
+            // nothing left to read,  ending not found
+            break;
+        }
+        u = *lexer->inbufptr++;
         lexer->outbuffer[i] = u;
         lexer->inbuflen--;
 
@@ -646,12 +652,6 @@ static void lexer_getline(struct gps_lexer_t *lexer)
             i++;
             break;
         }
-
-        if (0 == lexer->inbuflen) {
-            // nothing left to read,  ending not found
-            i++;
-            break;
-        }
     }
     lexer->outbuffer[i] = '\0';  // Ensure a NUL
     lexer->outbuflen = i;
