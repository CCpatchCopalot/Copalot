diff --git a/libfreerdp/core/security.c b/libfreerdp/core/security.c
--- a/libfreerdp/core/security.c
+++ b/libfreerdp/core/security.c
@@ -816,6 +816,9 @@
 {
 	size_t olen;
 
+	if (!rdp || !rdp->fips_decrypt)
+		return FALSE;
+
 	if (!winpr_Cipher_Update(rdp->fips_decrypt, data, length, data, &olen))
 		return FALSE;
 