diff --git a/src/p_tmt.cpp b/src/p_tmt.cpp
index e6f0ab3abe..21a8a0a005 100644
--- a/src/p_tmt.cpp
+++ b/src/p_tmt.cpp
@@ -172,7 +172,7 @@ void PackTmt::pack(OutputFile *fo) {
     obuf.allocForCompression(usize + rsize + 128);
 
     MemBuffer mb_wrkmem;
-    mb_wrkmem.alloc(rsize + EXTRA_INFO); // relocations
+    mb_wrkmem.alloc(rsize + EXTRA_INFO + 4); // relocations + original entry point + relocsize
     SPAN_S_VAR(upx_byte, wrkmem, mb_wrkmem);
 
     fi->seek(adam_offset + sizeof(ih), SEEK_SET);