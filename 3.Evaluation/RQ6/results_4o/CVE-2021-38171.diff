diff --git a/libavformat/adtsenc.c b/libavformat/adtsenc.c
--- a/libavformat/adtsenc.c
+++ b/libavformat/adtsenc.c
@@ -55,7 +55,9 @@
     MPEG4AudioConfig m4ac;
     int off;
 
-    init_get_bits(&gb, buf, size * 8);
+    ret = init_get_bits8(&gb, buf, size);
+    if (ret < 0)
+        return ret;
     off = avpriv_mpeg4audio_get_config2(&m4ac, buf, size, 1, s);
     if (off < 0)
         return off;