diff --git a/src/common/cidr.c b/src/common/cidr.c
index 59aaf872..4fc8aad2 100644
--- a/src/common/cidr.c
+++ b/src/common/cidr.c
@@ -362,6 +362,8 @@ parse_endpoints(tcpr_cidrmap_t ** cidrmap1, tcpr_cidrmap_t ** cidrmap2, const ch
         /* ipv4 mode */
         memset(newmap, '\0', NEWMAP_LEN);
         map = strtok_r(string, ":", &token);
+        if (map == NULL)
+            goto done;
 
         strlcpy(newmap, "0.0.0.0/0:", NEWMAP_LEN);
         strlcat(newmap, map, NEWMAP_LEN);