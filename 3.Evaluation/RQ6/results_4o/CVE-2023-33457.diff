diff --git a/src/util/URIParser.cc b/src/util/URIParser.cc
index 7e603fc6a4..cd1ed0b3e1 100644
--- a/src/util/URIParser.cc
+++ b/src/util/URIParser.cc
@@ -398,7 +398,8 @@
 				return -1;
 			}
 
-			if (i == URI_HOST && str[start_idx[i]] == '[')
+			if (i == URI_HOST && str[start_idx[i]] == '[' &&
+				str[end_idx[i] - 1] == ']')
 			{
 				len -= 2;
 				memcpy(*dst[i], str + start_idx[i] + 1, len);