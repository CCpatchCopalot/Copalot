diff --git a/src/receive.c b/src/receive.c
index 043c9f2..6bca9f4 100644
--- a/src/receive.c
+++ b/src/receive.c
@@ -171,6 +171,11 @@ static inline void handle_socket_receive_known(
 		fastd_handshake_handle(sock, local_addr, remote_addr, peer, buffer);
 		break;
 
+	default:
+		fastd_buffer_free(buffer);
+		pr_debug("received packet with invalid type from %P[%I]", peer, remote_addr);
+	}
+
 	case PACKET_HANDSHAKE:
 		fastd_handshake_handle(sock, local_addr, remote_addr, NULL, buffer);
 		break;
@@ -197,6 +202,11 @@ static inline void handle_socket_receive_unknown(
 		fastd_handshake_handle(sock, local_addr, remote_addr, NULL, buffer);
 		break;
 
+	default:
+		fastd_buffer_free(buffer);
+		pr_debug("received packet with invalid type from unknown address %I", remote_addr);
+	}
+
 	case PACKET_HANDSHAKE:
 		fastd_handshake_handle(sock, local_addr, remote_addr, NULL, buffer);
 		break;