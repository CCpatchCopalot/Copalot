diff --git a/libfreerdp/codec/ncrush.c b/libfreerdp/codec/ncrush.c
index eb7fc093f3f8..9f0985478a92 100644
--- a/libfreerdp/codec/ncrush.c
+++ b/libfreerdp/codec/ncrush.c
@@ -2079,6 +2079,8 @@
 		{
 			Mask = get_word(&HuffTableMask[29]);
 			MaskedBits = bits & Mask;
+			if (MaskedBits >= ARRAYSIZE(HuffTableLEC))
+				return -1;
 			IndexLEC = HuffTableLEC[MaskedBits] & 0xFFF;
 			BitLength = HuffTableLEC[MaskedBits] >> 12;
 			bits >>= BitLength;
@@ -2125,6 +2127,8 @@
 			CopyOffset = ncrush->OffsetCache[OffsetCacheIndex];
 			Mask = get_word(&HuffTableMask[21]);
 			MaskedBits = bits & Mask;
+			if (MaskedBits >= ARRAYSIZE(HuffTableLOM))
+				return -1;
 			LengthOfMatch = HuffTableLOM[MaskedBits] & 0xFFF;
 			BitLength = HuffTableLOM[MaskedBits] >> 12;
 			bits >>= BitLength;