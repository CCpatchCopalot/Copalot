diff --git a/htmldoc/file.c b/htmldoc/file.c
index fec96bd9..f2f3822c 100644
--- a/htmldoc/file.c
+++ b/htmldoc/file.c
@@ -334,7 +334,8 @@ file_extension(const char *s)	/* I - Filename or URL */
 
   strlcpy(buf, extension, sizeof(buf));
 
-  *(char *)strchr(buf, '#') = '\0';
+  if ((bufptr = strchr(buf, '#')) != NULL)
+    *bufptr = '\0';
 
   return (buf);
 }