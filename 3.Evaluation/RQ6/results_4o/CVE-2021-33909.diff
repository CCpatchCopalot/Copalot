diff --git a/fs/seq_file.c b/fs/seq_file.c
--- a/fs/seq_file.c
+++ b/fs/seq_file.c
@@ -32,6 +32,9 @@
 
 static void *seq_buf_alloc(unsigned long size)
 {
+	if (unlikely(size > MAX_RW_COUNT))
+		return NULL;
+
 	return kvmalloc(size, GFP_KERNEL_ACCOUNT);
 }
 
This diff snippet shows the critical security fix where a size validation check was added to prevent integer overflow vulnerabilities in buffer allocation. The `if (unlikely(size > MAX_RW_COUNT))` condition restricts allocations to sane sizes, directly addressing the described OOB write vulnerability.