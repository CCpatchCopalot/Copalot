diff --git a/src/jp2image.cpp b/src/jp2image.cpp
old mode 100644
new mode 100755
index 747145cf9..34f8a2dae
--- a/src/jp2image.cpp
+++ b/src/jp2image.cpp
@@ -273,6 +273,9 @@ namespace Exiv2
                             DataBuf data(subBox.length+8);
                             io_->read(data.pData_,data.size_);
                             long    iccLength = getULong(data.pData_+pad, bigEndian);
+                            if (iccLength > data.size_ - pad) {
+                                throw Error(58);
+                            }
                             DataBuf icc(iccLength);
                             ::memcpy(icc.pData_,data.pData_+pad,icc.size_);
 #ifdef DEBUG
