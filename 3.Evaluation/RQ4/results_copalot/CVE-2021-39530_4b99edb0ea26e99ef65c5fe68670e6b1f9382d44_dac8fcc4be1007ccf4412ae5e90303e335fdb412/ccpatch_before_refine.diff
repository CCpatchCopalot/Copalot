

diff --git a/src/dwg.spec b/src/dwg.spec
index ee4ffc21..4e8ad166 100644
--- a/src/dwg.spec
+++ b/src/dwg.spec
@@ -2997,9 +2997,15 @@ DWG_OBJECT (LTYPE)
           {
             if (_obj->dashes[rcount1].shape_flag & 2)
               {
-                static int dash_i = 0;
+                static unsigned int dash_i = 0;
+                if (dash_i >= 256)
+                  {
+                    LOG_ERROR ("dashes[%u] overflow @%u", rcount1, dash_i)
+                    break;
+                  }
                 _obj->dashes[rcount1].text = (char*)&_obj->strings_area[dash_i];
-                dash_i += strlen (_obj->dashes[rcount1].text) + 1;
+                LOG_TRACE ("dashes[%u] @%u\n", rcount1, dash_i)
+                dash_i += strnlen (_obj->dashes[rcount1].text, 256 - dash_i) + 1;
               }
           }
       }
@@ -3013,9 +3019,15 @@ DWG_OBJECT (LTYPE)
           {
             if (_obj->dashes[rcount1].shape_flag & 2)
               {
-                static int dash_i = 0;
+                static unsigned int dash_i = 0;
+                if (dash_i >= 512)
+                  {
+                    LOG_ERROR ("dashes[%u] overflow @%u", rcount1, dash_i)
+                    break;
+                  }
                 _obj->dashes[rcount1].text = (char*)&_obj->strings_area[dash_i];
-                dash_i += bit_wcs2len ((BITCODE_TU)_obj->dashes[rcount1].text) + 2;
+                LOG_TRACE ("dashes[%u] @%u\n", rcount1, dash_i)
+                dash_i += (2 * bit_wcs2nlen ((BITCODE_TU)_obj->dashes[rcount1].text, 256 - (dash_i / 2))) + 2;
               }
           }
       }