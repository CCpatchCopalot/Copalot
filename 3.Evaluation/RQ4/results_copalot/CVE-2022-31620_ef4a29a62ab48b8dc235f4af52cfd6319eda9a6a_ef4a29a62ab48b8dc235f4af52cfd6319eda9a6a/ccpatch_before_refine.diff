diff --git a/codestream/aclosslessscan.cpp b/codestream/aclosslessscan.cpp
index fcd8719..cbfd282 100644
--- a/codestream/aclosslessscan.cpp
+++ b/codestream/aclosslessscan.cpp
@@ -359,7 +359,9 @@ void ACLosslessScan::ParseMCU(struct Line **prev,struct Line **top)
             //
             while(m_Coder.Get(mset.X[i])) {
               m <<= 1;
-              i++;
+              if (++i >= QMContextSet::MagnitudeSet::MagnitudeContexts)
+                JPG_THROW(MALFORMED_STREAM,"ACLosslessScan::ParseMCU",
+                          "received an out-of-bounds signal while parsing an AC-coded lossless symbol");
             }
             //
             m >>= 1;