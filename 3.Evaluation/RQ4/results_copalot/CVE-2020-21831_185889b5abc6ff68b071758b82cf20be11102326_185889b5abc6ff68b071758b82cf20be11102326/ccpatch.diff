diff --git a/src/decode.c b/src/decode.c
old mode 100644
new mode 100755
index b79cd0d5..e65a3ee8
--- a/src/decode.c
+++ b/src/decode.c
@@ -2437,12 +2437,13 @@ read_2004_compressed_section (Bit_Chain *dat, Dwg_Data *restrict dwg,
         }
       else
         {
-          BITCODE_RL size;
-          if (info->compressed == 2
-              || bytes_left < 0
+          const unsigned long offset = address + es.fields.address + 32;
+          const BITCODE_RL size = MIN (info->size, info->max_decomp_size);
+          if (info->compressed == 2 || bytes_left < 0
               || (unsigned long)(es.fields.address + 32 + info->size
                                   > max_decomp_size)
-              )
+              || (j * info->max_decomp_size) + size > max_decomp_size
+              || offset + size > dat->size)
             {
               LOG_ERROR ("Some section size out of bounds")
               sec_dat->chain = NULL;
@@ -2451,9 +2452,7 @@ read_2004_compressed_section (Bit_Chain *dat, Dwg_Data *restrict dwg,
                                                : DWG_ERR_VALUEOUTOFBOUNDS;
             }
           // the remaining uncompressed size to read from
-          size = MIN (info->size, info->max_decomp_size);
-          memcpy (&decomp[j * info->max_decomp_size],
-                  &dat->chain[address + es.fields.address + 32], size);
+          memcpy (&decomp[j * info->max_decomp_size], &dat->chain[offset], size);
           bytes_left -= size;
           sec_dat->size += size;
         }
