diff --git a/src/H5T.c b/src/H5T.c
index eca0132756..589bd79d4f 100644
--- a/src/H5T.c
+++ b/src/H5T.c
@@ -5212,6 +5212,8 @@ H5T_set_loc(H5T_t *dt, H5F_t *f, H5T_loc_t loc)
                             /* Check if the field changed size */
                             if(old_size != memb_type->shared->size) {
                                 /* Adjust the size of the member */
+                                if (0 == old_size)
+                                    HGOTO_ERROR(H5E_DATATYPE, H5E_BADVALUE, FAIL, "old_size of zero would cause division by zero");
                                 dt->shared->u.compnd.memb[i].size = (dt->shared->u.compnd.memb[i].size*memb_type->shared->size)/old_size;
 
                                 /* Add that change to the accumulated size change */
