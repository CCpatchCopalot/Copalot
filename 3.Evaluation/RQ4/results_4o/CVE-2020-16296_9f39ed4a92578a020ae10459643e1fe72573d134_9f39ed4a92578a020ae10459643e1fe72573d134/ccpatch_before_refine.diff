

diff --git a/contrib/lips4/gdevlips.c b/contrib/lips4/gdevlips.c
index 11aa8323d..6dd07047f 100644
--- a/contrib/lips4/gdevlips.c
+++ b/contrib/lips4/gdevlips.c
@@ -160,7 +160,7 @@ GetNumWrongData(const byte * curPtr, const int maxnum)
     if (1 == maxnum) {
         return (1);
     }
-    while (*(curPtr + count) != *(curPtr + count + 1) && maxnum > count) {
+    while (maxnum > count+1 && *(curPtr + count) != *(curPtr + count + 1)) {
         count++;
     }
     return (count);