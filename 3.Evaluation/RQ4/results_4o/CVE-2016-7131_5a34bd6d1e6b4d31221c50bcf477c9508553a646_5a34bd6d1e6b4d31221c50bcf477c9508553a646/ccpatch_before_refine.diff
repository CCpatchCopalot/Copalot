

diff --git a/ext/wddx/wddx.c b/ext/wddx/wddx.c
index 1b2d103af1..d7bd295832 100644
--- a/ext/wddx/wddx.c
+++ b/ext/wddx/wddx.c
@@ -1179,6 +1179,10 @@ int php_wddx_deserialize_ex(char *value, int vallen, zval *return_value)
 
 	if (stack.top == 1) {
 		wddx_stack_top(&stack, (void**)&ent);
+		if(ent->data == NULL) {
+			retval = FAILURE;
+		} else {
 			*return_value = *(ent->data);
 			zval_copy_ctor(return_value);
 			retval = SUCCESS;
+		}
 	} else {