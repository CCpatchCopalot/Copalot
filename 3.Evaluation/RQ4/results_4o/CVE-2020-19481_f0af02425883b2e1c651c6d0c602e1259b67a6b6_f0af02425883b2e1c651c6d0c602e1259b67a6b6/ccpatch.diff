diff --git a/src/media_tools/mpegts.c b/src/media_tools/mpegts.c
index ef709fb12..d988332e9 100644
--- a/src/media_tools/mpegts.c
+++ b/src/media_tools/mpegts.c
@@ -1410,10 +1410,12 @@ static void gf_m2ts_process_pmt(GF_M2TS_Demuxer *ts, GF_M2TS_SECTION_ES *pmt, GF
 					es->stream_type = GF_M2TS_AUDIO_EC3;
 					break;
 				case GF_M2TS_DVB_DATA_BROADCAST_ID_DESCRIPTOR:
-				{
-					u32 id = data[2]<<8 | data[3];
-					if ((id == 0xB) && ses && !ses->sec) {
-						ses->sec = gf_m2ts_section_filter_new(NULL, 1);
+					if (len>=2) {
+						u32 id = data[2]<<8 | data[3];
+						if ((id == 0xB) && ses && !ses->sec) {
+							ses->sec = gf_m2ts_section_filter_new(NULL, 1);
+						}
 					}
-				}
-				break;
+					break;
 				case GF_M2TS_DVB_SUBTITLING_DESCRIPTOR:
 					if (pes) {
 						pes->sub.language[0] = data[2];
