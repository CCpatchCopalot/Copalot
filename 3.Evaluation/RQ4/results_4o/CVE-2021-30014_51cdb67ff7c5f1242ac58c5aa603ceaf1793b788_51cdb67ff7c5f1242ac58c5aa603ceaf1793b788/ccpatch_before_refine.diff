

The vulnerability in `hevc_parse_slice_segment` arises from an insufficient bounds check on `pps_id`, allowing negative values to cause an integer overflow. The patch fixes this by adding a check for negative `pps_id`. The critical diff is:

```diff
diff --git a/src/media_tools/av_parsers.c b/src/media_tools/av_parsers.c
index a30cfae9f..2698bbca9 100644
--- a/src/media_tools/av_parsers.c
+++ b/src/media_tools/av_parsers.c
@@ -6843,7 +6843,7 @@ s32 hevc_parse_slice_segment(GF_BitStream *bs, HEVCState *hevc, HEVCSliceInfo *s
 	}
 
 	pps_id = gf_bs_read_ue_log(bs, "pps_id");
-	if (pps_id >= 64)
+	if ((pps_id<0) || (pps_id >= 64))
 		return -1;
 
 	pps = &hevc->pps[pps_id];
```

This modification introduces a bounds check for negative `pps_id`, preventing an out-of-bounds array access that leads to a crash.