diff --git a/Source/C++/Core/Ap4TrunAtom.cpp b/Source/C++/Core/Ap4TrunAtom.cpp
index 5af43da..6784ee7 100644
--- a/Source/C++/Core/Ap4TrunAtom.cpp
+++ b/Source/C++/Core/Ap4TrunAtom.cpp
@@ -143,13 +143,20 @@ AP4_TrunAtom::AP4_TrunAtom(AP4_UI32        size,
     }
     
     int record_fields_count = (int)ComputeRecordFieldsCount(flags);
-    if (record_fields_count && ((bytes_left / (record_fields_count*4)) < sample_count)) {
+    if (!record_fields_count) {
+        // nothing to read
+        return;
+    }
+
+    if ((bytes_left / (record_fields_count*4)) < sample_count) {
         // not enough data for all samples, the format is invalid
         return;
     }
+
     if (AP4_FAILED(m_Entries.SetItemCount(sample_count))) {
         return;
     }
+        
     for (unsigned int i=0; i<sample_count; i++) {
         if (flags & AP4_TRUN_FLAG_SAMPLE_DURATION_PRESENT) {
             if (bytes_left < 4 || AP4_FAILED(stream.ReadUI32(m_Entries[i].sample_duration))) {