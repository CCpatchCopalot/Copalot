

diff --git a/src/isomedia/box_code_adobe.c b/src/isomedia/box_code_adobe.c
index 2ca8a2c22..79c81ab4b 100644
--- a/src/isomedia/box_code_adobe.c
+++ b/src/isomedia/box_code_adobe.c
@@ -169,8 +169,12 @@
 	ptr->segment_run_table_count = gf_bs_read_u8(bs);
 	for (i=0; i<ptr->segment_run_table_count; i++) {
-		GF_AdobeSegmentRunTableBox *asrt;
+		GF_AdobeSegmentRunTableBox *asrt = NULL;
 		e = gf_isom_box_parse((GF_Box **)&asrt, bs);
-		if (e) return e;
+		if (e) {
+			if (asrt) gf_isom_box_del((GF_Box*)asrt);
+			gf_free(tmp_str);
+			return e;
+		}
 		gf_list_insert(ptr->segment_run_table_entries, asrt, i);
 	}
 
@@ -178,8 +182,12 @@
 	ptr->fragment_run_table_count = gf_bs_read_u8(bs);
 	for (i=0; i<ptr->fragment_run_table_count; i++) {
-		GF_AdobeFragmentRunTableBox *afrt;
+		GF_AdobeFragmentRunTableBox *afrt = NULL;
 		e = gf_isom_box_parse((GF_Box **)&afrt, bs);
-		if (e) return e;
+		if (e) {
+			if (afrt) gf_isom_box_del((GF_Box*)afrt);
+			gf_free(tmp_str);
+			return e;
+		}
 		gf_list_insert(ptr->fragment_run_table_entries, afrt, i);
 	}
 
diff --git a/src/isomedia/box_code_base.c b/src/isomedia/box_code_base.c
index f18bb18e9..d33ddd116 100644
--- a/src/isomedia/box_code_base.c
+++ b/src/isomedia/box_code_base.c
@@ -3890,22 +3890,27 @@
 		ptr->cfg_3gpp = (GF_3GPPConfigBox *) a;
 		/*for 3GP config, remember sample entry type in config*/
 		ptr->cfg_3gpp->cfg.type = ptr->type;
+		ptr->is_qtff = 0;
 		break;
 
 	case GF_ISOM_BOX_TYPE_DOPS:
 		ptr->cfg_opus = (GF_OpusSpecificBox *)a;
+		ptr->is_qtff = 0;
 		break;
 	case GF_ISOM_BOX_TYPE_DAC3:
 		ptr->cfg_ac3 = (GF_AC3ConfigBox *) a;
+		ptr->is_qtff = 0;
 		break;
 	case GF_ISOM_BOX_TYPE_DEC3:
 		ptr->cfg_ac3 = (GF_AC3ConfigBox *) a;
+		ptr->is_qtff = 0;
 		break;
 	case GF_ISOM_BOX_TYPE_MHA1:
 	case GF_ISOM_BOX_TYPE_MHA2:
 	case GF_ISOM_BOX_TYPE_MHM1:
 	case GF_ISOM_BOX_TYPE_MHM2:
 		ptr->cfg_mha = (GF_MHAConfigBox *) a;
+		ptr->is_qtff = 0;
 		break;
 
 	case GF_ISOM_BOX_TYPE_UNKNOWN: