

```diff
diff --git a/src/decode.c b/src/decode.c
--- a/src/decode.c
+++ b/src/decode.c
@@ -2398,7 +2398,7 @@
               return error;
             }
           bytes_left -= info->max_decomp_size;
-          sec_dat->size = info->size;
+          sec_dat->size += info->max_decomp_size;
         }
       else
         {
@@ -2418,10 +2418,10 @@
                   &dat->chain[address + es.fields.address + 32],
                   MIN (bytes_left, info->max_decomp_size));
           bytes_left -= info->max_decomp_size;
-          sec_dat->size = info->size;
+          sec_dat->size += MIN (bytes_left, info->max_decomp_size);
         }
     }
-
+  sec_dat->size = info->size;
   return error;
 }
 
```