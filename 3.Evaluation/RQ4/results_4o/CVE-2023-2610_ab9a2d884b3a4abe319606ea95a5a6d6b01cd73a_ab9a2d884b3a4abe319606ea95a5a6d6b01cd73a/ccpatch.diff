diff --git a/src/regexp.c b/src/regexp.c
--- a/src/regexp.c
+++ b/src/regexp.c
@@ -1781,6 +1781,12 @@
 		// trouble at some point.
 		size_t	prevsublen = STRLEN(reg_prev_sub);
 		size_t  newsublen = STRLEN(newsub);
+		if (prevsublen > MAXCOL || newsublen > MAXCOL
+					    || newsublen + prevsublen > MAXCOL)
+		{
+		    emsg(_(e_resulting_text_too_long));
+		    break;
+		}
 
 		char_u *tmpsub = alloc(newsublen + prevsublen);
 		if (tmpsub != NULL)
