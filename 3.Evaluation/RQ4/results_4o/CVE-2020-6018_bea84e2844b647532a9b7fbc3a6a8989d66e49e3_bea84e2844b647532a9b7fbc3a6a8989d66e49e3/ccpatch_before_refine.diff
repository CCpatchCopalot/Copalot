

diff --git a/src/common/crypto_libsodium.cpp b/src/common/crypto_libsodium.cpp
index 7641399..483e985 100644
--- a/src/common/crypto_libsodium.cpp
+++ b/src/common/crypto_libsodium.cpp
@@ -72,6 +72,12 @@ bool AES_GCM_DecryptContext::Decrypt(
 	void *pPlaintextData, uint32 *pcbPlaintextData,
 	const void *pAdditionalAuthenticationData, size_t cbAuthenticationData
 ) {
+	// Make sure caller's buffer is big enough to hold the result
+	if ( cbEncryptedDataAndTag > *pcbPlaintextData + crypto_aead_aes256gcm_ABYTES )
+	{
+		*pcbPlaintextData = 0;
+		return false;
+	}
     unsigned long long pcbPlaintextData_longlong;
 
     const int nDecryptResult = crypto_aead_aes256gcm_decrypt_afternm(