diff --git a/tensorflow/core/platform/file_system_helper.cc b/tensorflow/core/platform/file_system_helper.cc
index 0c4c9aaf87b..3d447781aa2 100644
--- a/tensorflow/core/platform/file_system_helper.cc
+++ b/tensorflow/core/platform/file_system_helper.cc
@@ -128,3 +128,8 @@ Status GetMatchingPaths(FileSystem* fs, Env* env, const string& pattern,
 
 }  // namespace internal
 }  // namespace tensorflow
+  if(index < 0 || index >= int(sen))
+  {
+    in.clear(std::ios_base::badbit);
+    return false;
+  }
