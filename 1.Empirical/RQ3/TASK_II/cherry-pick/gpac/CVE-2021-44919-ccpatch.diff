diff --git a/src/scenegraph/vrml_tools.c b/src/scenegraph/vrml_tools.c
index 4720ded2a..48dbaa53c 100644
--- a/src/scenegraph/vrml_tools.c
+++ b/src/scenegraph/vrml_tools.c
@@ -1141,6 +1141,7 @@ GF_Err gf_sg_vrml_mf_alloc(void *mf, u32 FieldType, u32 NbItems)
 
 	if (gf_sg_vrml_is_sf_field(FieldType)) return GF_BAD_PARAM;
 	if (FieldType == GF_SG_VRML_MFNODE) return GF_BAD_PARAM;
+	if (!mffield) return GF_NON_COMPLIANT_BITSTREAM;
 
 	FieldSize = gf_sg_vrml_get_sf_size(FieldType);
 
