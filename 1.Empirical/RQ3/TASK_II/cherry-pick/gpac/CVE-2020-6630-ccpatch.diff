diff --git a/src/isomedia/isom_read.c b/src/isomedia/isom_read.c
index 0a356252e..0d5744b42 100644
--- a/src/isomedia/isom_read.c
+++ b/src/isomedia/isom_read.c
@@ -2982,6 +2982,7 @@ u64 gf_isom_get_media_data_size(GF_ISOFile *movie, u32 trackNumber)
 	GF_TrackBox *tk = gf_isom_get_track_from_file(movie, trackNumber);
 	if (!tk) return 0;
 	stsz = tk->Media->information->sampleTable->SampleSize;
+	if (!stsz) return 0;
 	if (stsz->sampleSize) return stsz->sampleSize*stsz->sampleCount;
 	size = 0;
 	for (i=0; i<stsz->sampleCount; i++) size += stsz->sizes[i];
