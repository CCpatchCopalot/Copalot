diff --git a/libr/io/io_bank.c b/libr/io/io_bank.c
index 2ebd1ee061..87981f20a2 100644
--- a/libr/io/io_bank.c
+++ b/libr/io/io_bank.c
@@ -230,12 +230,21 @@ R_API bool r_io_bank_map_add_top(RIO *io, const ut32 bankid, const ut32 mapid) {
 		r_io_submap_set_to (bd, r_io_submap_from (sm) - 1);
 		entry = r_rbnode_next (entry);
 	}
-	while (entry && r_io_submap_to (((RIOSubMap *)entry->data)) <= r_io_submap_to (sm)) {
-		//delete all submaps that are completly included in sm
-		RRBNode *next = r_rbnode_next (entry);
-		// this can be optimized, there is no need to do search here
-		r_crbtree_delete (bank->submaps, entry->data, _find_sm_by_from_vaddr_cb, NULL);
-		entry = next;
+	ut64 smto = r_io_submap_to (sm);
+	if (entry) {
+		ut64 ento = r_io_submap_to (((RIOSubMap*)entry->data));
+		while (entry && ento <= smto) {
+			//delete all submaps that are completly included in sm
+			RRBNode *next = r_rbnode_next (entry);
+			// this can be optimized, there is no need to do search here
+			// XXX this is a workaround to avoid an UAF in Reproducer: iobank-crash
+			ento = r_io_submap_to (((RIOSubMap*)entry->data));
+			bool a = r_crbtree_delete (bank->submaps, entry->data, _find_sm_by_from_vaddr_cb, NULL);
+			if (!a) {
+				next = NULL;
+			}
+			entry = next;
+		}
 	}
 	if (entry && r_io_submap_from (((RIOSubMap *)entry->data)) <= r_io_submap_to (sm)) {
 		bd = (RIOSubMap *)entry->data;
