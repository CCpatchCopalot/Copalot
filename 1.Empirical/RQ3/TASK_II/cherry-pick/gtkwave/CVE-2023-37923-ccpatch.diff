diff --git a/gtkwave3-gtk3/src/helpers/vcd2lxt.c b/gtkwave3-gtk3/src/helpers/vcd2lxt.c
index c985424..06d33f3 100644
--- a/gtkwave3-gtk3/src/helpers/vcd2lxt.c
+++ b/gtkwave3-gtk3/src/helpers/vcd2lxt.c
@@ -482,10 +482,10 @@ for(yytext[len++]=ch;;yytext[len++]=ch)
 	if(ch<=' ') break;
 	}
 yytext[len]=0;	/* terminator */
+yylen=len;
 
 if(is_string)
 	{
-	yylen=len;
 	return(T_STRING);
 	}
 
@@ -1137,7 +1137,7 @@ for(;;)
 		case T_SCOPE:
 			T_GET;
 			T_GET;
-			if(tok==T_STRING)
+			if (tok!= T_END && tok != T_EOF)
 				{
 				struct slist *s;
 				s=(struct slist *)calloc_2(1,sizeof(struct slist));
diff --git a/gtkwave3-gtk3/src/helpers/vcd2lxt2.c b/gtkwave3-gtk3/src/helpers/vcd2lxt2.c
index 7614a5a..08559f6 100644
--- a/gtkwave3-gtk3/src/helpers/vcd2lxt2.c
+++ b/gtkwave3-gtk3/src/helpers/vcd2lxt2.c
@@ -487,10 +487,10 @@ for(yytext[len++]=ch;;yytext[len++]=ch)
 	if(ch<=' ') break;
 	}
 yytext[len]=0;	/* terminator */
+yylen=len;
 
 if(is_string)
 	{
-	yylen=len;
 	return(T_STRING);
 	}
 
@@ -1139,7 +1139,7 @@ for(;;)
 		case T_SCOPE:
 			T_GET;
 			T_GET;
-			if(tok==T_STRING)
+			if (tok!= T_END && tok != T_EOF)
 				{
 				struct slist *s;
 				s=(struct slist *)calloc_2(1,sizeof(struct slist));
diff --git a/gtkwave3-gtk3/src/helpers/vcd2vzt.c b/gtkwave3-gtk3/src/helpers/vcd2vzt.c
index 4c3267c..d2be9d8 100644
--- a/gtkwave3-gtk3/src/helpers/vcd2vzt.c
+++ b/gtkwave3-gtk3/src/helpers/vcd2vzt.c
@@ -489,10 +489,10 @@ for(yytext[len++]=ch;;yytext[len++]=ch)
 	if(ch<=' ') break;
 	}
 yytext[len]=0;	/* terminator */
+yylen=len;
 
 if(is_string)
 	{
-	yylen=len;
 	return(T_STRING);
 	}
 
@@ -1149,7 +1149,7 @@ for(;;)
 		case T_SCOPE:
 			T_GET;
 			T_GET;
-			if(tok==T_STRING)
+			if (tok!= T_END && tok != T_EOF)
 				{
 				struct slist *s;
 				s=(struct slist *)calloc_2(1,sizeof(struct slist));
diff --git a/gtkwave3/src/helpers/vcd2lxt.c b/gtkwave3/src/helpers/vcd2lxt.c
index c985424..06d33f3 100644
--- a/gtkwave3/src/helpers/vcd2lxt.c
+++ b/gtkwave3/src/helpers/vcd2lxt.c
@@ -482,10 +482,10 @@ for(yytext[len++]=ch;;yytext[len++]=ch)
 	if(ch<=' ') break;
 	}
 yytext[len]=0;	/* terminator */
+yylen=len;
 
 if(is_string)
 	{
-	yylen=len;
 	return(T_STRING);
 	}
 
@@ -1137,7 +1137,7 @@ for(;;)
 		case T_SCOPE:
 			T_GET;
 			T_GET;
-			if(tok==T_STRING)
+			if (tok!= T_END && tok != T_EOF)
 				{
 				struct slist *s;
 				s=(struct slist *)calloc_2(1,sizeof(struct slist));
diff --git a/gtkwave3/src/helpers/vcd2lxt2.c b/gtkwave3/src/helpers/vcd2lxt2.c
index 7614a5a..08559f6 100644
--- a/gtkwave3/src/helpers/vcd2lxt2.c
+++ b/gtkwave3/src/helpers/vcd2lxt2.c
@@ -487,10 +487,10 @@ for(yytext[len++]=ch;;yytext[len++]=ch)
 	if(ch<=' ') break;
 	}
 yytext[len]=0;	/* terminator */
+yylen=len;
 
 if(is_string)
 	{
-	yylen=len;
 	return(T_STRING);
 	}
 
@@ -1139,7 +1139,7 @@ for(;;)
 		case T_SCOPE:
 			T_GET;
 			T_GET;
-			if(tok==T_STRING)
+			if (tok!= T_END && tok != T_EOF)
 				{
 				struct slist *s;
 				s=(struct slist *)calloc_2(1,sizeof(struct slist));
diff --git a/gtkwave3/src/helpers/vcd2vzt.c b/gtkwave3/src/helpers/vcd2vzt.c
index 4c3267c..d2be9d8 100644
--- a/gtkwave3/src/helpers/vcd2vzt.c
+++ b/gtkwave3/src/helpers/vcd2vzt.c
@@ -489,10 +489,10 @@ for(yytext[len++]=ch;;yytext[len++]=ch)
 	if(ch<=' ') break;
 	}
 yytext[len]=0;	/* terminator */
+yylen=len;
 
 if(is_string)
 	{
-	yylen=len;
 	return(T_STRING);
 	}
 
@@ -1149,7 +1149,7 @@ for(;;)
 		case T_SCOPE:
 			T_GET;
 			T_GET;
-			if(tok==T_STRING)
+			if (tok!= T_END && tok != T_EOF)
 				{
 				struct slist *s;
 				s=(struct slist *)calloc_2(1,sizeof(struct slist));
