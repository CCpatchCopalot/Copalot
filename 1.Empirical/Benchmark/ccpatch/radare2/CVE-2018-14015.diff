diff --git a/libr/bin/dwarf.c b/libr/bin/dwarf.c
index edd062c7ba..e068c4eb81 100644
--- a/libr/bin/dwarf.c
+++ b/libr/bin/dwarf.c
@@ -1364 +1364,5 @@ static const ut8 *r_bin_dwarf_parse_comp_unit(Sdb *s, const ut8 *obuf,
-				sdb_set (s, "DW_AT_comp_dir", name, 0);
+				if ((size_t)name > 1024) { // solve some null derefs
+					sdb_set (s, "DW_AT_comp_dir", name, 0);
+				} else {
+					eprintf ("Invalid string pointer at %p\n", name);
+				}
