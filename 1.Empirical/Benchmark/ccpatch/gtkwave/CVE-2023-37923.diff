diff --git a/gtkwave3-gtk3/src/helpers/vcd2lxt.c b/gtkwave3-gtk3/src/helpers/vcd2lxt.c
index db0efed3..319d82c8 100644
--- a/gtkwave3-gtk3/src/helpers/vcd2lxt.c
+++ b/gtkwave3-gtk3/src/helpers/vcd2lxt.c
@@ -433,10 +433,10 @@ for(yytext[len++]=ch;;yytext[len++]=ch)
 	if(ch<=' ') break;
 	}
 yytext[len]=0;	/* terminator */
+yylen=len;
 
 if(is_string)
 	{
-	yylen=len;
 	return(T_STRING);
 	}
 
@@ -1079,7 +1079,7 @@ for(;;)
 		case T_SCOPE:
 			T_GET;
 			T_GET;
-			if(tok==T_STRING)
+			if (tok!= T_END && tok != T_EOF)
 				{
 				struct slist *s;
 				s=(struct slist *)calloc_2(1,sizeof(struct slist));
diff --git a/gtkwave3-gtk3/src/helpers/vcd2lxt2.c b/gtkwave3-gtk3/src/helpers/vcd2lxt2.c
index dcfacf3e..1e8bd299 100644
--- a/gtkwave3-gtk3/src/helpers/vcd2lxt2.c
+++ b/gtkwave3-gtk3/src/helpers/vcd2lxt2.c
@@ -438,10 +438,10 @@ for(yytext[len++]=ch;;yytext[len++]=ch)
 	if(ch<=' ') break;
 	}
 yytext[len]=0;	/* terminator */
+yylen=len;
 
 if(is_string)
 	{
-	yylen=len;
 	return(T_STRING);
 	}
 
@@ -1081,7 +1081,7 @@ for(;;)
 		case T_SCOPE:
 			T_GET;
 			T_GET;
-			if(tok==T_STRING)
+			if (tok!= T_END && tok != T_EOF)
 				{
 				struct slist *s;
 				s=(struct slist *)calloc_2(1,sizeof(struct slist));
diff --git a/gtkwave3-gtk3/src/helpers/vcd2vzt.c b/gtkwave3-gtk3/src/helpers/vcd2vzt.c
index b360f566..d49ac5cd 100644
--- a/gtkwave3-gtk3/src/helpers/vcd2vzt.c
+++ b/gtkwave3-gtk3/src/helpers/vcd2vzt.c
@@ -440,10 +440,10 @@ for(yytext[len++]=ch;;yytext[len++]=ch)
 	if(ch<=' ') break;
 	}
 yytext[len]=0;	/* terminator */
+yylen=len;
 
 if(is_string)
 	{
-	yylen=len;
 	return(T_STRING);
 	}
 
@@ -1091,7 +1091,7 @@ for(;;)
 		case T_SCOPE:
 			T_GET;
 			T_GET;
-			if(tok==T_STRING)
+			if (tok!= T_END && tok != T_EOF)
 				{
 				struct slist *s;
 				s=(struct slist *)calloc_2(1,sizeof(struct slist));
diff --git a/gtkwave3-gtk3/src/vcd.c b/gtkwave3-gtk3/src/vcd.c
index c836955e..eae6c820 100644
--- a/gtkwave3-gtk3/src/vcd.c
+++ b/gtkwave3-gtk3/src/vcd.c
@@ -427,10 +427,10 @@ for(GLOBALS->yytext_vcd_c_1[len++]=ch;;GLOBALS->yytext_vcd_c_1[len++]=ch)
 	if(ch<=' ') break;
 	}
 GLOBALS->yytext_vcd_c_1[len]=0;	/* terminator */
+GLOBALS->yylen_vcd_c_1=len;
 
 if(is_string)
 	{
-	GLOBALS->yylen_vcd_c_1=len;
 	return(T_STRING);
 	}
 
@@ -1183,7 +1183,7 @@ for(;;)
                                 }
 
 			T_GET;
-			if(tok==T_STRING)
+			if (tok!= T_END && tok != T_EOF)
 				{
 				struct slist *s;
 				s=(struct slist *)calloc_2(1,sizeof(struct slist));
diff --git a/gtkwave3-gtk3/src/vcd_partial.c b/gtkwave3-gtk3/src/vcd_partial.c
index 9c5990bc..6f3ffe80 100644
--- a/gtkwave3-gtk3/src/vcd_partial.c
+++ b/gtkwave3-gtk3/src/vcd_partial.c
@@ -404,10 +404,10 @@ for(GLOBALS->yytext_vcd_partial_c_2[len++]=ch;;GLOBALS->yytext_vcd_partial_c_2[l
 	if(ch<=' ') break;
 	}
 GLOBALS->yytext_vcd_partial_c_2[len]=0;	/* terminator */
+GLOBALS->yylen_vcd_partial_c_2=len;
 
 if(is_string)
 	{
-	GLOBALS->yylen_vcd_partial_c_2=len;
 	return(T_STRING);
 	}
 
@@ -1132,7 +1132,7 @@ for(;;)
                                         }
                                 }
 			T_GET;
-			if(tok==T_STRING)
+			if (tok!= T_END && tok != T_EOF)
 				{
 				struct slist *s;
 				s=(struct slist *)calloc_2(1,sizeof(struct slist));
diff --git a/gtkwave3-gtk3/src/vcd_recoder.c b/gtkwave3-gtk3/src/vcd_recoder.c
index 3d0e7da7..39159886 100644
--- a/gtkwave3-gtk3/src/vcd_recoder.c
+++ b/gtkwave3-gtk3/src/vcd_recoder.c
@@ -932,10 +932,10 @@ for(GLOBALS->yytext_vcd_recoder_c_3[len++]=ch;;GLOBALS->yytext_vcd_recoder_c_3[l
 	if(ch<=' ') break;
 	}
 GLOBALS->yytext_vcd_recoder_c_3[len]=0;	/* terminator */
+GLOBALS->yylen_vcd_recoder_c_3=len;
 
 if(is_string)
 	{
-	GLOBALS->yylen_vcd_recoder_c_3=len;
 	return(T_STRING);
 	}
 
@@ -1525,7 +1525,7 @@ for(;;)
 					}
 				}
 			T_GET;
-			if(tok==T_STRING)
+			if (tok != T_END && tok != T_EOF)
 				{
 				struct slist *s;
 				s=(struct slist *)calloc_2(1,sizeof(struct slist));

diff --git a/gtkwave3/src/helpers/vcd2lxt.c b/gtkwave3/src/helpers/vcd2lxt.c
index db0efed3..319d82c8 100644
--- a/gtkwave3/src/helpers/vcd2lxt.c
+++ b/gtkwave3/src/helpers/vcd2lxt.c
@@ -433,10 +433,10 @@ for(yytext[len++]=ch;;yytext[len++]=ch)
 	if(ch<=' ') break;
 	}
 yytext[len]=0;	/* terminator */
+yylen=len;
 
 if(is_string)
 	{
-	yylen=len;
 	return(T_STRING);
 	}
 
@@ -1079,7 +1079,7 @@ for(;;)
 		case T_SCOPE:
 			T_GET;
 			T_GET;
-			if(tok==T_STRING)
+			if (tok!= T_END && tok != T_EOF)
 				{
 				struct slist *s;
 				s=(struct slist *)calloc_2(1,sizeof(struct slist));
diff --git a/gtkwave3/src/helpers/vcd2lxt2.c b/gtkwave3/src/helpers/vcd2lxt2.c
index dcfacf3e..1e8bd299 100644
--- a/gtkwave3/src/helpers/vcd2lxt2.c
+++ b/gtkwave3/src/helpers/vcd2lxt2.c
@@ -438,10 +438,10 @@ for(yytext[len++]=ch;;yytext[len++]=ch)
 	if(ch<=' ') break;
 	}
 yytext[len]=0;	/* terminator */
+yylen=len;
 
 if(is_string)
 	{
-	yylen=len;
 	return(T_STRING);
 	}
 
@@ -1081,7 +1081,7 @@ for(;;)
 		case T_SCOPE:
 			T_GET;
 			T_GET;
-			if(tok==T_STRING)
+			if (tok!= T_END && tok != T_EOF)
 				{
 				struct slist *s;
 				s=(struct slist *)calloc_2(1,sizeof(struct slist));
diff --git a/gtkwave3/src/helpers/vcd2vzt.c b/gtkwave3/src/helpers/vcd2vzt.c
index b360f566..d49ac5cd 100644
--- a/gtkwave3/src/helpers/vcd2vzt.c
+++ b/gtkwave3/src/helpers/vcd2vzt.c
@@ -440,10 +440,10 @@ for(yytext[len++]=ch;;yytext[len++]=ch)
 	if(ch<=' ') break;
 	}
 yytext[len]=0;	/* terminator */
+yylen=len;
 
 if(is_string)
 	{
-	yylen=len;
 	return(T_STRING);
 	}
 
@@ -1091,7 +1091,7 @@ for(;;)
 		case T_SCOPE:
 			T_GET;
 			T_GET;
-			if(tok==T_STRING)
+			if (tok!= T_END && tok != T_EOF)
 				{
 				struct slist *s;
 				s=(struct slist *)calloc_2(1,sizeof(struct slist));
diff --git a/gtkwave3/src/vcd.c b/gtkwave3/src/vcd.c
index c836955e..eae6c820 100644
--- a/gtkwave3/src/vcd.c
+++ b/gtkwave3/src/vcd.c
@@ -427,10 +427,10 @@ for(GLOBALS->yytext_vcd_c_1[len++]=ch;;GLOBALS->yytext_vcd_c_1[len++]=ch)
 	if(ch<=' ') break;
 	}
 GLOBALS->yytext_vcd_c_1[len]=0;	/* terminator */
+GLOBALS->yylen_vcd_c_1=len;
 
 if(is_string)
 	{
-	GLOBALS->yylen_vcd_c_1=len;
 	return(T_STRING);
 	}
 
@@ -1183,7 +1183,7 @@ for(;;)
                                 }
 
 			T_GET;
-			if(tok==T_STRING)
+			if (tok!= T_END && tok != T_EOF)
 				{
 				struct slist *s;
 				s=(struct slist *)calloc_2(1,sizeof(struct slist));
diff --git a/gtkwave3/src/vcd_partial.c b/gtkwave3/src/vcd_partial.c
index a1785076..7bffd1c2 100644
--- a/gtkwave3/src/vcd_partial.c
+++ b/gtkwave3/src/vcd_partial.c
@@ -403,10 +403,10 @@ for(GLOBALS->yytext_vcd_partial_c_2[len++]=ch;;GLOBALS->yytext_vcd_partial_c_2[l
 	if(ch<=' ') break;
 	}
 GLOBALS->yytext_vcd_partial_c_2[len]=0;	/* terminator */
+GLOBALS->yylen_vcd_partial_c_2=len;
 
 if(is_string)
 	{
-	GLOBALS->yylen_vcd_partial_c_2=len;
 	return(T_STRING);
 	}
 
@@ -1131,7 +1131,7 @@ for(;;)
                                         }
                                 }
 			T_GET;
-			if(tok==T_STRING)
+			if (tok!= T_END && tok != T_EOF)
 				{
 				struct slist *s;
 				s=(struct slist *)calloc_2(1,sizeof(struct slist));
diff --git a/gtkwave3/src/vcd_recoder.c b/gtkwave3/src/vcd_recoder.c
index a17e4cd5..52539f41 100644
--- a/gtkwave3/src/vcd_recoder.c
+++ b/gtkwave3/src/vcd_recoder.c
@@ -932,10 +932,10 @@ for(GLOBALS->yytext_vcd_recoder_c_3[len++]=ch;;GLOBALS->yytext_vcd_recoder_c_3[l
 	if(ch<=' ') break;
 	}
 GLOBALS->yytext_vcd_recoder_c_3[len]=0;	/* terminator */
+GLOBALS->yylen_vcd_recoder_c_3=len;
 
 if(is_string)
 	{
-	GLOBALS->yylen_vcd_recoder_c_3=len;
 	return(T_STRING);
 	}
 
@@ -1525,7 +1525,7 @@ for(;;)
 					}
 				}
 			T_GET;
-			if(tok==T_STRING)
+			if (tok != T_END && tok != T_EOF)
 				{
 				struct slist *s;
 				s=(struct slist *)calloc_2(1,sizeof(struct slist));