diff --git a/lib/vtls/x509asn1.c b/lib/vtls/x509asn1.c
old mode 100644
new mode 100755
index 8407940ce..032ad73a5
--- a/lib/vtls/x509asn1.c
+++ b/lib/vtls/x509asn1.c
@@ -356,11 +356,11 @@ utf8asn1str(struct dynbuf *to, int type, const char *from, const char *end)
   case CURL_ASN1_UTF8_STRING:
     break;
   default:
-    return -1;  /* Conversion not supported. */
+    return CURLE_BAD_FUNCTION_ARGUMENT;  /* Conversion not supported. */
   }
 
   if(inlength % size)
-    return -1;  /* Length inconsistent with character size. */
+    return CURLE_BAD_FUNCTION_ARGUMENT;
 
   if(type == CURL_ASN1_UTF8_STRING) {
     /* Just copy. */
@@ -389,7 +389,7 @@ utf8asn1str(struct dynbuf *to, int type, const char *from, const char *end)
           if(wc >= 0x00010000) {
             if(wc >= 0x00200000) {
               free(buf);
-              return -1;        /* Invalid char. size for target encoding. */
+              return CURLE_WEIRD_SERVER_REPLY;
             }
             buf[3] = (char) (0x80 | (wc & 0x3F));
             wc = (wc >> 6) | 0x00010000;
@@ -407,7 +407,7 @@ utf8asn1str(struct dynbuf *to, int type, const char *from, const char *end)
       result = Curl_dyn_addn(to, buf, charsize);
     }
   }
-  return result ? (ssize_t) -1 : (ssize_t)Curl_dyn_len(to);
+  return result;
 }
 
 /*
