diff --git a/src/H5Opline.c b/src/H5Opline.c
index e817f9ad75..eae3d33d8f 100644
--- a/src/H5Opline.c
+++ b/src/H5Opline.c
@@ -139,9 +139,13 @@ H5O_pline_decode(H5F_t H5_ATTR_UNUSED *f, hid_t H5_ATTR_UNUSED dxpl_id, H5O_t H5
 
     /* Number of filters */
     pline->nused = *p++;
-    if(pline->nused > H5Z_MAX_NFILTERS)
-	HGOTO_ERROR(H5E_PLINE, H5E_CANTLOAD, NULL, "filter pipeline message has too many filters")
-
+    if(pline->nused > H5Z_MAX_NFILTERS) {
+        /* Reset the number of filters used to avoid array traversal in error
+         * handling code.
+         */
+        pline->nused = 0;
+        HGOTO_ERROR(H5E_PLINE, H5E_CANTLOAD, NULL, "filter pipeline message has too many filters")
+    }
     /* Reserved */
     if(pline->version == H5O_PLINE_VERSION_1)
         p += 6;
