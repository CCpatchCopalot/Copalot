diff --git a/src/decode.c b/src/decode.c
index 2ce22343..f46321b2 100644
--- a/src/decode.c
+++ b/src/decode.c
@@ -2126 +2126,7 @@ read_R2004_section_info (Bit_Chain *restrict dat, Dwg_Data *restrict dwg,
-
+      if (info->size > info->num_sections * info->max_decomp_size)
+      {
+        LOG_ERROR ("Skip section %s with size %lu > %d * " FORMAT_RL,
+                    info->name, info->size, info->num_sections, info->max_decomp_size);
+        info->max_decomp_size = info->size = info->num_sections = 0;
+        error |= DWG_ERR_VALUEOUTOFBOUNDS;
+      }
@@ -2334 +2340 @@ read_2004_compressed_section (Bit_Chain *dat, Dwg_Data *restrict dwg,
-
+  sec_dat->size = 0;
@@ -2401 +2407 @@ read_2004_compressed_section (Bit_Chain *dat, Dwg_Data *restrict dwg,
-          sec_dat->size = info->size;
+          sec_dat->size += info->max_decomp_size;
@@ -2421 +2427 @@ read_2004_compressed_section (Bit_Chain *dat, Dwg_Data *restrict dwg,
-          sec_dat->size = info->size;
+           sec_dat->size += MIN (bytes_left, info->max_decomp_size);
@@ -2424 +2430 @@ read_2004_compressed_section (Bit_Chain *dat, Dwg_Data *restrict dwg,
-
+    sec_dat->size = info->size;
